Wireless charging holds significant promise for IoT devices and transportation networks by facilitating convenient and autonomous power supply. Traditional wireless charging technologies have typically adhered to a singular approach, choosing between near-field coupling or far-field radiation. However, our investigations uncover that each method outperforms the other at specific distances. This insight leads us to integrating the advantages of both to enable rapid wireless charging across any distance within the charging range. For this vision, we poses an intriguing question: "Can we develop a system that supports both near-field and far-field charging simultaneously?" We give an affirmative answer by introducing ChargeM, a novel wireless charging system that explores frequency diversity at the transceiver to support different modes. By controlling the transceiver to operate at disparate frequency bands, ChargeM can automatically and safely switch the charging mode according to the location of charging devices, thus enabling continuous fast charging. Furthermore, the smart metasurface is involved to perform beam-forming for high-efficient power transfer with a compact receiver. We propose new hardware component design methods to support multi-mode power transfer, and tailored a fast receiver localization strategy to guide metasurface and transmitter control. Finally, we developed a prototype of ChargeM for charging small mobile devices, and evaluated its performance through controlled experiments and real-world charging. Extensive experiments demonstrate that ChargeM supports both near-field and far-field charging, achieving charging distance of up to 2 m with a low transmit power of 20W.