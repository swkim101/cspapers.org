Trigger-action programming has been a success in end-user programming. Traditionally, the simplicity of links between triggers and actions limits the expressivity of such systems. LLM-based code generation promises to enable users to specify more complex behavior in natural language. However, users need appropriate ways to understand and control this added expressive power. We introduce Ply, a system that tackles this challenge through the following techniques: (1) a layer abstraction that enables decomposition into smaller building blocks; (2) generated visualizations at each layer boundary to enable interrogation of the behavior of generated code; and (3) generated customizable parameters, with associated configuration UIs, to allow users to tune each layer’s behavior. We offer a technical evaluation of Ply, demonstrating how custom programs can be authored and tested incrementally using this layered trigger-action technique. Additionally, we describe a first-use study with seven participants, demonstrating where and how Ply’s generative features can affect how users build programs.