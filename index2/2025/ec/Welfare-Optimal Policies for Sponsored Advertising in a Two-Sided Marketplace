Two-sided marketplaces such as Amazon, Alibaba, Google, and Yelp connect customers with providers and commonly rank providers based on quality while allowing them to promote themselves through sponsored ads. This paper develops a game-theoretic model of such platforms, where providers strategically choose customer prices and advertising intensity in response to the platform's ad placement and pricing policy. The analysis characterizes equilibrium outcomes and examines how platforms can design policies to optimize key objectives. The results show that ranking sponsored ads by the product of bid and clickthrough rate—a widely used heuristic—always maximizes supply-side surplus, defined as the sum of provider profits and platform revenue. To also enhance customer surplus, platforms should discount the per-impression cost of ads based on estimated provider quality, enabling providers that better meet customer needs to pay less per impression. This quality-adjusted pricing rule achieves the best possible multiplicative guarantee relative to the first-best social welfare, which includes both supply-side and customer surplus. In contrast, when provider quality is imperfectly estimated, removing sponsored ads and relying solely on organic rankings yields strictly worse welfare guarantees. These results offer prescriptive guidance for platform design and establish normative benchmarks for evaluating digital marketplace policies. Link to the full paper: https://ssrn.com/abstract=5132218