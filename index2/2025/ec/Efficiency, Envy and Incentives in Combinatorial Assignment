Ensuring efficiency and envy-freeness in allocating indivisible goods without money often requires randomization. However, existing combinatorial assignment mechanisms (for applications such as course allocation, food banks, and refugee resettlement) guarantee these properties either ex ante or ex post, but not both. We propose a new class of mechanisms based on Competitive Equilibrium from Random Incomes (CERI): Agents receive random token budgets and select optimal lotteries at competitive prices that clear markets in expectation. Our main insight is to let the CERI price vector guide all ex-post allocations. We show that all ordinally efficient allocations are CERI allocations, which can be implemented as lotteries over near-feasible Pareto-efficient outcomes. With identical budget distributions, CERI allocations are ordinally envy-free; with budget distributions on small supports, ex-post allocations are envy-free up to one good. Moreover, we design an asymptotically efficient implementation of CERI that satisfies a strong new non-manipulability property in large markets.