We ask when additional data collection by a monopolist to engage in price discrimination monotonically increases or decreases weighted surplus. To answer this question, we develop a model to study endogenous market segmentation subject to residual uncertainty. We give a complete characterization of when data collection is good or bad for surplus, which consists of a reduction of the problem to one with only two demand curves, and a condition for the two-demand-curves case that highlights three distinct effects of information on welfare. These results provide insights into when data collection and usage for price discrimination should be allowed.