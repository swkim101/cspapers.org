The computer organization course must help students acquire difficult conceptual knowledge and design skills, and improve their teamwork skills for subsequent project courses. Prior research supports that cooperative learning, in which students work together to achieve common goals, may address these challenges. We studied whether increasing the amount of guided inquiry activities and the cooperative support for it (teams and reflection) in an intermediate computer science course would improve achievement and engagement. The intervention group had lower scores on one of two achievement measures, lower engagement, and lower task value of collaborative activities. Qualitative analysis showed that students valued hands-on learning yet resisted guided inquiry, suggesting that sharing the purpose of each type of activity is important. Furthermore, the results showed that students valued learning with peers but were frustrated by group dysfunction, suggesting that instructors must address teamwork comprehensively to realize the benefits of cooperative learning.