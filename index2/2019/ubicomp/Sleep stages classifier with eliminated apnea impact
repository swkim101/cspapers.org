This paper provides a novel best in the domain automatic classifier of sleep stages based on wrist photoplethysmography and 3D-accelerometer data obtained from smartwatches. The sleep is classified into rapid-eye-movement (REM), Light, Deep, or Wake stages. State of the art classifiers based on wearable sensors suffer from motion artifacts and apnea events. Proposed novel techniques of artifacts and apnea events elimination result in the high accuracy of sleep stages classification and robustness to apnea events. The model provides the Cohen's Kappa score of 0.65 and accuracy of 0.80 on 254 night-logs of 173 subjects with a broad distribution of apnea-hypopnea index until 90. The approach is applicable to unobtrusive sleep monitoring by wearables.