In CPS security research, a test environment and datasets that reflect the real world are crucial. We have constructed the HAI testbed, which provides a function to automatically control all sensors and actuators. Moreover, we have published a control system dataset named HAI dataset, obtained from the testbed according to a premeditated physical attack scenario. Although the HAI dataset sufficiently simulates the behavior of the field devices, the dataset does not contain the phase of cyberattack propagation through the network. In this study, we expanded the HAI testbed to reproduce and analyze network attacks and verified an expanded HAI testbed.