Unsupervised Domain Adaptation(UDA) in semantic segmentation reduces the dependence on pixel level labeling. It uses labeled source domain datasets and unlabeled target domain images to learn to segment the network. This article proposes a domain adaptive framework that combines decoupled adversarial network and self-training. The problem of over fitting the source domain in domain adaptation and the inability of the network to focus on segmentation tasks has been solved. Considering the impact of the long tailed distribution of data, the Rare Class Sampling (RCS) module is introduced. In order to make full use of pseudo-labels, we designed a self-training UDA scheme using weighted pseudo-labels. At the same time, the RCS module for rare class sampling improves the quality of pseudo-labels by reducing the recognition bias of self-training on public classes. The LoveDA dataset is the latest domain adaptive dataset for land cover mapping. In urban-to-rural and rural-to-urban scenarios, our proposed UDA method has significant advantages.