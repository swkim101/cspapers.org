This paper provides a strategic non-cooperative model of large firms interacting in an input-output network consisting of many specific supply-customer relationships, with an application to mergers. It does so introducing the technique of competition in schedules, or supply and demand functions, to the modeling of general equilibrium oligopoly. The main interest lies in the fact that such a technique allows to have a fully strategic model in which firms understand and take into account their position in the network, and have market power on both inputs and outputs markets simultaneously, in an endogenously determined way. These features are rarely both present in input-output models of the macroeconomy, but I argue that they are important to analyze market power in input-output networks. For example, I show that they can generate large differences in the ranking of market power across firms or sectors with respect to a model where market power is one-sided, as in the classic sequential Cournot. This implies different evaluations of the welfare impact of mergers. The effect is particularly stark especially when supply chains are long. These results suggest that the technique of competition in supply and demand functions can be important for the researcher interested in analyzing and estimating economies with market power, especially in the presence of complex input-output networks. Formally, firms have each a set of input and output goods, some of which are in turn outputs or inputs of other firms, and these trade relationships, or input-output links, are exogenous. Firms play a simultaneous game in which the available actions are supply and demand schedules, relating quantities of the traded goods to prices (as in the seminal paper by [Klemperer and Meyer, 1989]): as in a double auction, the realized price on every trade relationship is the one where demand and supply cross. The classic metaphor for the price-taking general equilibrium behavior is that a "walrasian" auctioneer proposes prices and collects supply and demand "bids", until all markets clear. Here, the auctioneer acts as a market maker in financial markets (e.g. as in [Malamud and Rostek, 2017]), collecting firms' conditional schedules, and firms, being non-infinitesimal, fully internalize the mechanism and submit their schedules to affect prices in their favor. As a consequence, firms' ability to affect prices is endogenous, and all firms charge markups on the output and markdowns on the inputs, contrary to [Acemoglu and Tahbaz-Salehi, 2020] in which the trading protocol results in an efficient equilibrium for exogenous networks. I provide a parameterized functional form for the production functions of firms that allows to considerably simplify the analysis, allowing the existence of an equilibrium in linear strategies. The paper can be found at this link: https://ideas.repec.org/p/sef/csefwp/648.html.