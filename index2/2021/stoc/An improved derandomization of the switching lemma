We prove a new derandomization of Håstad’s switching lemma, showing how to efficiently generate restrictions satisfying the switching lemma for DNF or CNF formulas of size m using only O(logm) random bits. Derandomizations of the switching lemma have been useful in many works as a key building-block for constructing objects which are in some way provably-pseudorandom with respect to AC0-circuits. Here, we use our new derandomization to give an improved analysis of the pseudorandom generator of Trevisan and Xue for AC0-circuits (CCC’13): we show that the generator ε-fools size-m, depth-D circuits with n-bit inputs using only O(log(m/ε)D · logn) random bits. In particular, we obtain (modulo the loglog-factors hidden in the O-notation) a dependence on m/ε which is best-possible with respect to currently-known AC0-circuit lower bounds.