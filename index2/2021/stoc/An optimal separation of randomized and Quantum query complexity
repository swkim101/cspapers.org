We prove that for every decision tree, the absolute values of the Fourier coefficients of given order t≥1 sum to at most (cd/t)t/2(1+logn)(t−1)/2, where n is the number of variables, d is the tree depth, and c>0 is an absolute constant. This bound is essentially tight and settles a conjecture due to Tal (arxiv 2019; FOCS 2020). The bounds prior to our work degraded rapidly with t, becoming trivial already at t=√d. As an application, we obtain, for every integer k≥1, a partial Boolean function on n bits that has bounded-error quantum query complexity at most ⌈ k/2⌉ and randomized query complexity Ω(n1−1/k). This separation of bounded-error quantum versus randomized query complexity is best possible, by the results of Aaronson and Ambainis (STOC 2015). Prior to our work, the best known separation was polynomially weaker: O(1) versus Ω(n2/3−є) for any є>0 (Tal, FOCS 2020). As another application, we obtain an essentially optimal separation of O(logn) versus Ω(n1−є) for bounded-error quantum versus randomized communication complexity, for any є>0. The best previous separation was polynomially weaker: O(logn) versus Ω(n2/3−є) (implicit in Tal, FOCS 2020).