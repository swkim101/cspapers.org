This paper proposes a real-time obstacle avoidance control scheme for a 6-DOF manipulator with a tool in the end effector. The system consists of environment monitoring, robot-tool segmentation and collision-free motion planning of the manipulator. A Kinect V2 RGB-D camera is used to track obstacles including human and objects in the working environment. The K-D tree algorithm is then adopted to cluster point clouds of the tool and the obstacles. For robot-tool segmentation, we propose a method to model the tool in the end effector and predict its pose in order to solve the camera occlusion problem. For collision-free motion planning, a novel potential field algorithm is proposed to take into consideration of the pose of the tool. A virtual torque approach is proposed and added to the potential field in order to generate a smoother and shorter avoidance motion. The experimental results on a TM5-700 cobot show that the manipulator with a tool in the end effector effectively avoided an obstacle in real time and completed the assigned task. It is shown that the path length with the proposed virtual torque is shortened by 80.43% compared with the case without using the virtual torque.