We consider a market run by an operator who seeks to satisfy a given consumer demand for a commodity by purchasing the needed amount from a group of competing suppliers with non-convex cost functions. The operator knows the suppliers' cost functions and announces a price/payment function for each supplier, which determines the payment to that supplier for producing different quantities. Each supplier then makes an individual decision about how much to produce (and whether to participate at all), in order to maximize its own profit. The key question is how to design the price functions. This problem is relevant for many applications, including electricity markets. The main contribution of this paper is the introduction of a new pricing scheme, \name (\acr ) pricing, which is applicable to general non-convex costs, allows using general parametric price functions, and guarantees market clearing, revenue adequacy, and ecomonic efficiency while supporting comptitive euqilibrium. The name of this scheme stems from the fact that we directly impose all the equilibrium conditions as constraints in the optimization problem for finding the best allocations, as opposed to adjusting the prices later to make the allocations an equilibrium. While the optimization problem is, of course, non-convex, and non-convex problems are intractable in general, we present a tractable approximation algorithm for solving the proposed optimization problem. Our framework extends to the case of networked markets, which, to the best of our knowledge, has not been considered in previous work.