Cyber-physical systems (CPSs) are used in a variety of domains such as critical infrastructure, smart factory, transportation, etc. Since dependable CPSs tend to be configured for specific tasks that are performed repeatedly, security threats to CPSs have started increasing. To enhance CPS security, it is necessary to realistically reproduce and test scenarios that reflect the characteristics of the target system. Prior to developing technologies for CPS security, individual experimental environments are necessary to evaluate the developed technologies. In this paper, we propose a Controller-in-the-Middle (CitM) scheme that provides a flexible experimental environment for CPS security, which consists of an independent process exchanged between field devices and a complex process combining different independent processes. Using the proposed scheme, various scenarios and test environment can be reproduced flexibly.