In process of localization in wireless sensor networks (WSNs),to improve localization precision, lower network cost and reduce network consumption, mobile anchor node-based localization algorithms for WSNs are ceaselessly put forward and improved. In WSNs localization algorithm with a few mobile anchor nodes, the whole network is utterly dependent on the few mobile anchor nodes, which causes serious security hidden dangers. In this case, we study existing methods and propose a secure localization algorithm based on anchor node identity authentication and communication encryption security policy. Comparing to the conventional methods, the algorithm is able to effectively isolate impersonation attacks from hostile nodes. We simulate with the method and the result shows that our method can effectively restrain impersonation attacks.