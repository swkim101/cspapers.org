This paper presents a SRGM (software reliability growth model) from testing to operation based on NHPP (nonhomogeneous Poisson process). Although a few research projects have been devoted to the differences between testing environment and operational environment, Consideration of the variation of environmental influence factors along testing time in the existing models is limited. The model in this paper is the first scheme of a few NHPP models that take environmental factors experimented from actual failure data as a function of testing time. FDR (fault detection rate) is usually used to measure the effectiveness of fault detection by test techniques and test cases. A bell-shaped FDR function of testing phase is proposed which integrate both environmental factors and inherent FDR per fault. A NHPP SRGM from testing to operation that incorporates environmental factors called TOE-SRGM is built which integrates the proposed FDR of testing phase and FDR function of operational phase. TOE-SRGM is evaluated using software failure data. The results show that the predictive power of TOE-SRGM is better than some of other SRGMs.