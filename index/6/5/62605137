To extend the flexibility of data integrity verification method,adapted to the different verification environment, proposed an improved solution that can support multi-granularity.It organizes files into three kinds of granularity such as data blocks,data sub-blocks and basic-blocks,basic-block realize data gathered to form data sub-block.Sign in the data sub-block,using signature of the sub-block to generate signature of block. Improvement program can achieve the verification of data blocks and sub-blocks. Validation of data block can reduce the data traffic in the validation process,two particle combination can improve the overall efficiency.In the proposed layered merkel hash tree is put forward,the dynamic operation can be supported by the sub-block or the block.Securitycommunication performance analysis show that the improvement program is effective and has a better practicability