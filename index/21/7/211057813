In this paper we propose a novel IoT platform, called SoPIoT, that is different from existing IoT platforms in several aspects. Since a device is abstracted with a set of services it provides, any computing resources can be easily integrated in the platform. In addition, SoPIoT allows a user to define a composite service dynamically at run-time by a script language program. To this end, a high-level script language is defined to easily express a composite service. To SoPIoT, the IoT system looks like a distributed system that consists of many computing resources, running multiple applications concurrently where an application corresponds to a composite service. The central middleware maps and schedules the services to the computing resources. The scalability of SoPIoT is achieved by forming the hierarchy of middlewares.