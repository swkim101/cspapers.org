Version 4 of the widely deployed Kerberos authentication protocol encrypts essential information without adequate authentication. We have implemented an efficient chosen-plaintext attack that uses this design flaw to impersonate arbitrary principals. Related flaws exist in version 5 of the protocol. We discuss the mistakes in the design of the protocol that contribute to these vulnerabilities, and how to avoid making them. We identify corrective measures taken in the proposed revisions to version 5, which repair these flaws.