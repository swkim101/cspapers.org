An ad-hoc wireless sensor network-based system is presented that detects and accurately locates shooters even in urban environments. The system consists of a large number of cheap sensors communicating through an ad-hoc wireless network, thus it is capable of tolerating multiple sensor failures, provides good coverage and high accuracy, and is capable of overcoming multipath effects. The performance of the proposed system is superior to that of centralized countersniper systems in such challenging environment as dense urban terrain. In this paper, in addition to the overall system architecture, the acoustic signal detection, the most important middleware services and the unique sensor fusion algorithm are also presented. The system performance is analyzed using real measurement data obtained at a US Army MOUT (Military Operations in Urban Terrain) facility.