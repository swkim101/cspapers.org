In order to automate repetitive tasks performed in computer applications, users are required to acquire special skills for writing macros or probwams Pro&~amming by demonstration (PBD), a method of converting a user demonstration into an executable code, is one possible solution to this problem, However, many PBD systems require users to spend much time and care in macro definition. This paper describes a PBD system, DemoOffice, which employs two techniques, actzon sllcug and macro auto-d<jinltlon, to simplifi macro definition significantly. The system is able to detect user actions which might be expected to be performed again in the fhture and to automatically convert those actions into a macro, for which no further definition is required,