In many-to-one matching with contracts, agents on one side of the market, e.g., workers, can fulfill at most one contract, while agents on the other side of the market, e.g., firms, may desire multiple contracts. Hatfield and Molgrom [6] showed that when firms' preferences are substitutable and size monotonic, the worker-proposing cumulative offer mechanism is stable and strategy-proof (for workers). Recently, stable and strategy-proof matching has been shown to be possible in a number of real-world settings in which preferences are not necessarily substitutable (see, e.g., Sönmez ans Switzer, [13], Sönmez [12] Kamada and Kojima [7], and Aygün and Turhan [1]; this has motivated a search for weakened substitutability conditions that guarantee the existence of stable and strategy-proof mechanisms. Hatfield and Kojima [3] introduced unilateral substitutability and showed that when all firms' preferences are unilaterally substitutable (and size monotonic), the cumulative offer mechanism is stable and strategy-proof. Kominers and Sönmez [9] identified a novel class of preferences, called slot-specific priorities, and showed that if each firm's preferences are in this class, then the cumulative offer mechanism is again stable and strategy-proof. Subsequently, Hatfield and Kominers [4] developed a concept of substitutable completion and showed that when each firm's preferences admit a size monotonic substitutable completion, the cumulative offer mechanism is once more stable and strategy-proof. In this paper, we introduce three novel conditions---observable substitutability, observable size monotonicity, and non-manipulability via contractual terms---and show that when these conditions are satisfied, the cumulative offer mechanism is the unique mechanism that is stable and strategy-proof. Moreover, when the choice function of any firm fails one of our three conditions, we can construct unit-demand choice functions for the other firms such that no stable and strategy-proof mechanism exists. Our results give the first characterization of sufficient and necessary conditions for the guaranteed existence of stable and strategy-proof mechanisms for many-to-one matching with contracts. Our conditions are strictly weaker than the previously known sufficient conditions for the existence of stable and strategy-proof mechanisms; this enables new applications, as well as a new interpretation of prior models of matching with distributional constraints (Hatfield et al. [5]; see also Kamada and Kojima [7,8]). Additionally, our work gives a foundation for the use of cumulative offer mechanisms in many-to-one matching markets with contracts: Whenever a stable and strategy-proof matching mechanism exists, either it must coincide with a cumulative offer mechanism, or its stability and/or strategy-proofness depends crucially on some specific interdependence of preferences across hospitals that rules out certain unit-demand choice functions.