Ecologists instrument ecosystems to collect time series representing the evolution in time and space of relevant abiotic and biotic factors. Sensor networks promise to improve on existing data acquisition systems by interconnecting stand-alone measurement systems into virtual instruments. Such ecological sensor networks, however, will only fulfill their potential if they meet the scientists requirements. In an ideal world, an ecologist expresses requirements in terms of a target dataset, which the sensor network then actually collects and stores. In fact, failures occur and interesting events happen, making uniform systematic ecosystem sampling neither possible nor desirable. Today, these anomalous situations are handled as exceptions treated by technicians that receive an alert at deployment time. In this paper, we detail how ecological sensor networks can maximize the utility of the collected datasets in a changing environment. More specifically, we present the design of a controller that continuously maintains its state based on the data obtained from the sensor network (as well as external systems), and configures motes with parameters that satisfy a constraint optimization problem derived from the current state, the system requirements, and the scientist requirements. We describe our implementation, discuss its scalability, and discuss its performance in the context of two case studies.