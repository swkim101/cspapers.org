For any <i>p</i> ∈ [0, 2], we give a 1-pass poly(ε<sup>-1</sup> log <i>n</i>)-space algorithm which, given a data stream of length <i>m</i> with insertions and deletions of an <i>n</i>-dimensional vector <i>a</i>, with updates in the range { -- <i>M</i>, -- <i>M</i> + 1, ..., <i>M</i> -- 1, <i>M</i>}, outputs a sample of [<i>n</i>] = {1, 2, ..., <i>n</i>} for which for all <i>i</i> the probability that <i>i</i> is returned is (1 ± ε) |<i>a</i><sub><i>i</i></sub>|<i>p</i>/<i>F</i><sub><i>p</i></sub>(<i>a</i>) ± <i>n<sup>-C</sup></i>, where <i>a</i><sub><i>i</i></sub> denotes the (possibly negative) value of coordinate <i>i</i>, <i>F</i><sub><i>p</i></sub>(<i>a</i>) = Σ<i><sup>n</sup></i><sub><i>i</i>=1</sub> |<i>a</i><sub><i>i</i></sub>|<i><sup>p</sup></i> = ||<i>a</i>||<i><sup>p</sup></i><sub><i>p</i></sub> denotes the <i>p</i>-th frequency moment (i.e., the <i>p</i>-th power of the <i>L</i><sub><i>p</i></sub> norm), and <i>C</i> > 0 is an arbitrarily large constant. Here we assume that <i>n, m</i>, and <i>M</i> are polynomially related.
 Our generic sampling framework improves and unifies algorithms for several communication and streaming problems, including cascaded norms, heavy hitters, and moment estimation. It also gives the first relative-error forward sampling algorithm in a data stream with deletions, answering an open question of Cormode <i>et al</i>.