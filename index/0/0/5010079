Ridesharing platforms match drivers and riders to trips, using dynamic prices to balance supply and demand. Despite having radically changed the way people get around in urban areas, there still remain a number of major challenges, undercutting their stated mission of "providing transportation as reliable as running water." A particular concern is that with the real-time flexibility to decide when and where to drive, drivers will strategize to improve their own income: calling riders to find out their destinations and canceling trips that are not worthwhile, declining trips and chasing surge prices in neighboring areas, and going off-line before large events end in anticipation of a price increase. Many of these incentive issues are a symptom of suboptimal dispatching, and a lack of smoothness in pricing in both time and space. For example, matching drivers to trips that sends them away from a sports stadium five minutes before a game ends, and at low prices, is inefficient, and drivers are responding to a suboptimal design, and may be acting to improve efficiency. In this paper, we study how to provide reliable and efficient transportation in the presence of spatial imbalances and temporal variations in supply and demand, while leaving drivers with the flexibility to decide how to work. We work in a complete information, discrete time, multi-period, multi-location model, and introduce the Spatio-Temporal Pricing (STP) mechanism. With information about supply and demand over a planning horizon, the STP mechanism solves for the welfare-optimal matching via a reduction to a minimum cost flow problem, and uses a connection between LP duality and market equilibrium to set prices that are smooth in both space and time. Without using penalties or time-extended contracts, the mechanism achieves incentive-alignment for drivers, in that it is a subgame-perfect equilibrium for drivers to always accept their trip dispatches. The mechanism is also robust to drivers' deviations, in that from any history onward, the equilibrium outcome under the mechanism is welfare-optimal, individually rational, budget balanced, core-selecting, and envy-free (drivers at the same location at the same time do not envy each other's downstream payoff). We also prove an impossibility result, that there can be no dominant-strategy mechanism with the same economic properties. An empirical analysis conducted in simulation suggests that the STP mechanism can achieve significantly higher social welfare than a myopic pricing mechanism.