Data centers often consolidate a variety of workloads to increase storage utilization and reduce management costs. Each workload, however, has its own performance targets that need to be met, requiring isolation from the effects of other workloads sharing the system. Satisfying the global throughput and latency targets of each workload is challenging in fully distributed storage systems because workloads can have different data layouts and different requests from the same workload can be serviced by different nodes. Quality of service schemes that manage individual system resources usually rely on resource reservations, often requiring assumptions about the layout of data. On the other hand, solutions for distributed storage tend to treat the storage system as a black box, metering requests issued to the system and often under-utilizing system resources.
 We show that our multi-layered approach that locally manages individual disk resources can deliver global throughput and latency targets while efficiently utilizing system resources. Our system uses upper-level control mechanisms to assign deadlines to requests based on workload performance targets, and low-level disk I/O schedulers designed to meet request deadlines while maximizing throughput at the disk. We provide a novel disk scheduler called Horizon that meets deadlines while providing efficient request re-ordering and keeping efficient disk queues. Our experimental results show that Horizon can meet more than 90% of deadlines while remaining efficient even in the presence of low-latency bursty workloads.