Energy is a global concern and the electricity bills nowadays are leading to unprecedented costs. Electricity price is market-based and dynamic. In this paper, we investigate how to cut the electricity bills of commercial buildings in a dynamic power market. The building thermal systems (e.g., air-conditioning), which dominate electricity bills, has a special property of thermal storage, i.e., the energy will not immediately dissipate from thermal air/water. Intuitively, with storage, the energy can be "stored" in the thermal system, making it possible to purchase electricity in low price and use it at appropriate time. The building thermal supply and electricity purchasing surely depends on human activities that the building should support such as class and meeting schedules. To minimize electricity bills, we develop a holistic planning of electricity purchasing schedule with thermal storage management, and appropriate room assignment schedules for classes/meetings usage. The computing algorithms require inputs of physical modeling on energy consumption. We develop wireless sensing systems to collect fine-grained data which are used to assist the cross-disciplinary physical modeling. We conduct validation through real experiments. We formulate an optimization problem and show that it is NP-complete. Our primary focus is to minimize electricity bills, which matches the incentives of the commercial buildings. We show that this does not coincide with energy conservation. We further investigate the relationship of minimization of electricity bills and minimization of energy consumption. We develop algorithms for our problem and our evaluation shows that we can achieve a 40% cost reduction.