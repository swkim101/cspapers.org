Spatiotemporal query is a new type of data service that allows a user to periodically gather information from a geographic area that moves with the user. A defining feature of this new service model is that each query result is subject to a set of spatiotemporal constraints in terms of response time, data freshness, and changing locations of data sources due to user mobility. We have developed MobiQuery to support spatiotemporal query services in a wireless sensor network environment. MobiQuery can work with in-network aggregation, energy conservation, and motion prediction techniques. A novel just-in-time prefetching mechanism is employed to provide spatiotemporal performance guarantees despite extremely low node duty cycles and unpredictable communication delays in sensor networks, while still achieving significant energy conservation. We also provide theoretical analysis and ns-2 simulation results which demonstrate the robustness and efficiency of MobiQuery under a range of realistic settings.