We give a 1-pass <i>Õ</i>(<i>m</i><sup>1-2⁄<i>k</i></sup>)-space algorithm for computing the <i>k</i>-th frequency moment of a data stream for any real <i>k</i> > 2. Together with the lower bounds of [1, 2, 4], this resolves the main problem left open by Alon et al in 1996 [1]. Our algorithm also works for streams with deletions and thus gives an <i>Õ</i>(<i>m</i> <sup>1-2⁄p</sup>) space algorithm for the <i>L</i><i><inf>p</inf></i> difference problem for any p > 2. This essentially matches the known Ω(<i>m</i><sup>1-2⁄<i>p</i>-<i>o</i>(1)</sup>) lower bound of [12, 2]. Finally the update time of our algorithms is <i>Õ</i>(1).