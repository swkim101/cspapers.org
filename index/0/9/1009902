We analyze the general version of the classic guessing game Mastermind with n positions and k colors. Since the case k ≤ n1 − ε, ε > 0 a constant, is well understood, we concentrate on larger numbers of colors. For the most prominent case k = n, our results imply that Codebreaker can find the secret code with O(nlog log n) guesses. This bound is valid also when only black answer pegs are used. It improves the O(nlog n) bound first proven by Chvátal. We also show that if both black and white answer pegs are used, then the O(nlog log n) bound holds for up to n2log log n colors. These bounds are almost tight, as the known lower bound of Ω(n) shows. Unlike for k ≤ n1 − ε, simply guessing at random until the secret code is determined is not sufficient. In fact, we show that an optimal nonadaptive strategy (deterministic or randomized) needs Θ(nlog n) guesses.