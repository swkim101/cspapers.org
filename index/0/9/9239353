Anonymity is increasingly important for network applications concerning about censorship and privacy. The existing anonymous communication protocols generally stem from mixnet and DC-net. They either cannot provide provable anonymity or suffer from transmission collision. In this paper, we introduce a novel approach which takes advantage of hierarchical ring structure and mix technique. This proposed protocol is collision free and provides provable k-anonymity for both the sender and the recipient, even if a polynomial time adversary can eavesdrop all network traffic and control a fraction of participants. Furthermore, it can hide the sender and the recipient from each other and thus can be used for anonymous file sharing. The analysis shows the proposed protocol is secure against various attacks. Measurements further demonstrate it is practical.