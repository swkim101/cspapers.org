It is being more than 30 years since first researches in Wireless Sensor and Actor Networks (WSAN) started to appear. However, despite been acknowledged one of the top emerging technologies for the 21st century, WSANs are not still a ubiquitous technology. Factors that have hindered its development are the lack of standards and protocols that support QoS and the complexity of designing and implementing WSAN applications. This thesis focus on overcoming these factors by means of a middleware that provides: 1) QoS support, necessary for applications such as the Protection of Critical Infrastructures (CIP), and 2) a flexible programming abstraction that helps the developer to implement WSAN applications and specify their QoS requirements without having to deal with low level repetitive tasks.