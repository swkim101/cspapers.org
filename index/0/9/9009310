Improving business processes is critical to any corporation. Process improvement requires analysis as its first basic step. Process analysis has many unique challenges: i) companies execute many business processes, and devising ad hoc solutions for each of them is too costly. Hence, generic approaches must be sought; ii) the abstraction level at which processes need to be analyzed is much higher with respect to the information available in the process execution environment; iii) the rapidly increasing need of co-developing the process analysis and the process automation solution and the scale of the problem makes it hard to cope with frequent changes in the sources of process data. To address these problems, we have developed a process warehousing solution, used by HP and its customers. In this paper we describe the solution, the challenges we had to face, and the lessons we learned in implementing and deploying it.