Fujitsu is providing solutions for scientific computing, from clusters of high-end PCs, through SMP UltraSparc-based systems, up to the VPP5000, the machine with the fastest single processor in production. The decision to use MPI-2 on all the platforms and to support common software tools was based on the availability of a generic message-passing kernel - MPLib. MPLib is a simple and reliable communication API library that supports both single and two-sided communication protocols. This API is also the basis for native PVM, Linda, P4 and Global Arrays for all Fujitsu systems. Here we explain how MPI-2 was developed on MPLib to provide a sophisticated and efficient message-passing environment, in particular on the VPP5000. We describe the embedded tools technology used to develop performance analyzers as MPLib plugins. The efficiency of the implementation is evaluated not only with the traditional ping-pong and ping-ping tests, but also with a standard test from an independent software company, PALLAS. MPI-2 latency on the VPP5000 is 4.5 microseconds, and a 32-processor machine sustains a global message-passing throughput of 92.8 GigaBytes per second.