A Euclidean <i>approximate sparse recovery</i> system consists of parameters k,N, an m-by-N <i>measurement matrix</i>, Φ, and a decoding algorithm, D. Given a vector, x, the system approximates x by ^x=D(Φ x), which must satisfy ||<sup>x</sup> - x||<sub>2</sub>≤ C ||x - x<sub>k</sub>||<sub>2</sub>, where x<sub>k</sub> denotes the optimal k-term approximation to x. (The output ^x may have more than k terms). For each vector x, the system must succeed with probability at least 3/4. Among the goals in designing such systems are minimizing the number m of measurements and the runtime of the decoding algorithm, D.
 In this paper, we give a system with m=O(k log(N/k)) measurements--matching a lower bound, up to a constant factor--and decoding time k log<sup>{O(1)</sup> N, matching a lower bound up to log(N) factors. We also consider the encode time (<i>i.e.</i>, the time to multiply Φ by x), the time to update measurements (<i>i.e.</i>, the time to multiply Φ by a 1-sparse x), and the robustness and stability of the algorithm (adding noise before and after the measurements). Our encode and update times are optimal up to log(k) factors. The columns of Φ have at most O(log<sup>2</sup>(k)log(N/k)) non-zeros, each of which can be found in constant time. Our full result, an FPRAS, is as follows. If x=x<sub>k</sub>+ν<sub>1</sub>, where ν<sub>1</sub> and ν<sub>2</sub> (below) are arbitrary vectors (regarded as noise), then, setting ^x = D(Φ x + ν<sub>2</sub>), and for properly normalized ν, we get [||^x - x||<sub>2</sub><sup>2</sup> ≤ (1+ε)||ν<sub>1</sub>||<sub>2</sub><sup>2</sup> + ε||ν<sub>2</sub>||<sub>2</sub><sup>2</sup>,] using O((k/ε)log(N/k)) measurements and (k/ε)log<sup>O(1)</sup>(N) time for decoding.