We develop shadow routing based online algorithms for the joint problem of application-to-VM and VM-to-PM assignments in a cloud environment. The asymptotic optimality of the shadow algorithm is proved and the performance is evaluated by simulations.