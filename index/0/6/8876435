Pedestrian dead reckoning (PDR) is a promising complementary technique to balance the requirements on both accuracy and costs in outdoor and indoor positioning systems. In this paper, we propose a unified framework to comprehensively tackle the three sub problems involved in PDR, including step detection and counting, heading estimation and step length estimation, based on sequentially rotating the device (reference) frame to the Earth (reference) frame through sensor fusion. To be specific, a robust step detection and counting algorithm is devised according to vertical angular velocities and turns out to be tolerant of various smartphone placements; then, a zero velocity update (ZUPT) based algorithm is leveraged to calibrate the measurements in the Earth frame; on these grounds, the heading and step length are further estimated by exploiting the cyclic features of walking. A thorough and extensive experimental analysis is conducted and confirms the effectiveness and advantages of the proposed PDR framework as well as the corresponding algorithms.