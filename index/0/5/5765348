—Mobile applications are increasingly integrating third-party libraries to provide various features, such as advertising, analytics, social networking, and more. Unfortunately, such integration with third-party libraries comes with the cost of potential privacy violations of users, because Android always grants a full set of permissions to third-party libraries as their host applications. Unintended accesses to users’ private data are underestimated threats to users’ privacy, as complex and often obfuscated third-party libraries make it hard for application developers to estimate the correct behaviors of third-party libraries. More critically, a wide adoption of native code (JNI) and dynamic code executions such as Java reﬂection or dynamic code reloading, makes it even harder to apply state-of- the-art security analysis. In this work, we propose F LEX D ROID , a new Android security model and isolation mechanism, that provides dynamic, ﬁne-grained access control for third-party libraries. With F LEX D ROID , application developers not only can gain a full control of third-party libraries (e.g., which permissions to grant or not), but also can specify how to make them behave after detecting a privacy violation (e.g., providing a mock user’s information or kill). To achieve such goals, we deﬁne a new notion of principals for third-party libraries, and develop a novel security mechanism, called inter-process stack inspection that is effective to JNI as well as dynamic code execution. Our usability study shows that developers can easily adopt F LEX D ROID ’s policy to their existing applications. Finally, our evaluation shows that F LEX D ROID can effectively restrict the permissions of third-party libraries with negligible overheads.