Microgrids are desired in remote areas, such as islands and under developed countries. However, given the limited capacities of local energy generation and storage in such a community, it is extremely challenging for an isolated microgrid to balance the power demand and generation in real-time with dynamically changing energy demand. Meanwhile, more and more sensing devices (such as smart meters) are deployed in individual homes to monitor real-time energy data, which can be helpful for homes and microgrid to better schedule the workload and generation. However, it is still difficult to conduct real-time distributed control due to the unreliable sensing devices and communications between sensing devices and controllers. To address these issues in microgrids, we designed a novel approach for the system to i) process the collected sensing data, ii) reconstruct the missing data caused by sensing error or unreliable communication, and iii) predict the future demand for real-time distributed control with missing data in extreme situations. The control center then decides the operations of the local generator and each home decides the scheduling of the flexible workload of appliances based on the collected and predicted data. We conducted extensive experiments and simulations with real world energy consumption data from 100 homes for one year. The evaluation results show that our design can recover the missing data with more than 99% accuracy and our distributed control can balance power demand and generation in real-time and reduce the operational cost by 23%.