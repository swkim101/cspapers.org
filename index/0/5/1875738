The presence of long gaps dramatically increases the difficulty of detecting and characterizing complex events hidden in long sequences. In order to cope with this problem, a learning algorithm based on an abstraction mechanism is proposed: it can infer a Hierarchical Hidden Markov Model, from a learning set of sequences. The induction algorithm proceeds bottom-up, progressively coarsening the sequence granularity, and letting correlations between subsequences, separated by long gaps, naturally emerge. As a case study, the method is evaluated on an application of user profiling. The results show that the proposed algorithm is suitable for developing real applications in network security and monitoring.