This paper presents a method for closed-loop propulsion of a screw-type magnetic capsule with embedded Hall-effect sensors using a single rotating actuator magnet. The method estimates the six-degree-of-freedom (6-DOF) pose of the capsule while it is synchronously rotating with the applied field. It is intended for application in active capsule endoscopy of the intestines. An extended Kalman filter, which uses a simplified 2-DOF process model restricting the capsule to forward or backward movement and rotation about its principle axis, is used to provide a full 6-DOF estimate of the capsule's pose as the capsule travels through a lumen. The capsule's movement in the applied field is constantly monitored to determine if the capsule is synchronously rotating with the applied field. Based on this information, the rotation speed of the external source is adjusted to prevent a loss in the desired magnetic coupling. We experimentally demonstrate, for the first time, simultaneous localization and closed-loop propulsion of a capsule through a lumen using a single rotating magnet. Prior work assumed the capsule had no net motion during the localization phase, requiring decoupled localization and propulsion. This closed-loop performance results in a three times speed up in completion time, compared to the previous decoupled approach.