A framework is presented to investigate product form expres - sions for circuit or packet switching random access protocols such as multihop-CSMA. Acceptation, retransmission and delay or acceleration functions are included. The transmission times and packet lenghts are generally distributed. A concrete invariance condition on the system functions is given which guarantÃ«es an insensitive product form. This condition unifies and extends known results. Several new examples are obtained. In particular, recently derived product form expressions for multihop-CSMA protocols are generalized.