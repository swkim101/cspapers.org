Choosing appropriate models is crucial in analyzing complex physical phenomena, especial ly when supercomput ing resources and complex par t ia l dif ferential equations are involved. This paper presents an approach to fo rmula t ing mathemat ica l models guided by the structure of a domain theory and the gross behavior of a physical problem. The approach is mot ivated by the observation that many physical domains, though complex and computat ional ly expensive to analyze, have strong domain theories based on a few fundamenta l conservation laws and well-defined physical processes. Furthermore, model ing decisions have to be guided by the behavior specific to a physical problem that the system is t r y i ng to model . By exp lo i t ing a domain theory and using problem specific behavior, the approach offers an un i fo rm and efficient way of fo rmula t ing models of various complexi ty, ranging f rom algebraic, ordinary to par t ia l dif ferential equations. The approach has been implemented in a computer program, M S G , and tested in the heat transfer domain. 1 I n t r o d u c t i o n Model ing is an impor tan t f irst step in scientific computa t ion and engineering analysis. To understand a physical phenomenon requires a representation of the phenomenon in the f o rm of a mathemat ica l model , carrying out simulations of the model , and interpret ing the data f rom the simulat ions. The fo rm of the model has a dramatic impact on the cost and the accuracy "Most of the work was done at Rutgers UniverBity and partially supported by NSF under Grant Number DMC8610507, by the Rutgers Center for Computer Aids to Industrial Productivity, and by ARPA under Grant N00014-81-K0394 and by ARPA and NASA under ARPA-funded NASA grant NAG2-645. I would like to thank Lou Steinberg for his guidance and support, and Saul Amarel, Andrew Gelsey, Yogesh Jaluria, Elaine Kant, Bob Vichnevetsky and members of the CAP project for their comments. Also thanks to Bob Boehm, Richard Marciano and three anonymous reviewers for their feedback to the earlier versions of this paper. in understanding the phenomenon. The impact is even more significant in analyzing complex physical phenomena that require h igh performance and supercomput ing resources. A few crucial approximat ions can t ransform complex par t ia l differential equations to ordinary different ial equations or algebraic equations, w i th the differences in resource requirements between supercomputers and workstat ions. Th is paper describes an approach to fo rmula t ing models. The models include not only algebraic and ordinary differential equations for model ing lumped phenomena, but also partial dif ferential equations for model ing dist r ibuted phenomena, i.e. values of physical phenomena vary w i t h t ime and spatial dimensions. Th is approach is based on two principles: • the use of the structure of a domain theory to focus the approximat ions on choosing the types and the number of basic physical processes, and — to sequence the model ing process around the structure of the conservation laws. • the use of the gross behavior of a physical phenomenon, obtained through simple approximate models, to guide its model ing decisions. The approach is targeted to domains where strong domain theories exist and s imple approximate models for est imat ing gross behavior are available. It is mot ivated by the observation that many physical domains have strong and well-defined domain theories f rom which models are derived. These domain theories are based on several fundamenta l conservation laws and well-defined physical processes that are governed by domain-specific laws. Examples of these domains are heat transfer, fluid mechanics and st ructura l analysis where the laws of conservation of mass, of energy, and of momen tum are the fundamenta l laws and the domain-specific laws relate the basic processes of mass, energy and momen tum to the properties of materials in their respective domains. By organizing the model ing process around the structure of a domain theory, we can provide an un i fo rm approach to fo rmula t ing models of various complexi ty. The approach is also mot iva ted by the need of incorporat ing problem specific behavior of physical phenomena into model ing decisions. A model reflects the behavior 1766 QUALITATIVE REASONING AND DIAGNOSIS of a physical problem at hand and the decisions behind the models have to be made w i th in the context of the behavior. Bu t how do we obta in the problem specific behavior to guide the model ing decisions? Simple and approximate models exist in a domain that can be used to obta in the gross behavior of a problem. These models only give the estimates of the gross behavior of a problem, e.g., the m a x i m u m temperature drop instead of the temperature d is t r ibu t ion in a sol id. However, these models are simple to compute, and the gross behavior is often adequate for mak ing the model ing decisions. Using the gross behavior of a prob lem, obtained f rom these approximate models, allows a system to quickly focus on a l ikely candidate model for the problem at hand. The approach has been implemented in a computer program, MSG (Model Selection and Generation), which formulates mathemat ica l models in the heat transfer doma in . The models in this domain involve algebraic, ordinary and par t ia l differential equations, for model ing lumped and d is t r ibuted heat transfer phenomena. The paper is structured as follows. Section 2 in t roduces the domain theory of heat transfer and its im plications for organizing the model ing process. Section 3 presents the gross behavior of heat transfer and the methods for obta in ing them. Section 4 describes the program MSG implement ing this approach and an example problem. Section 5 describes several features of this approach. Section 6 compares this approach w i th related work, fol lowed by the summary in Section 7. 2 Model ing Process Structured by Domain Theory Many complex physical domains have well-developed doma in theories that are based on several fundamental conservation laws and a set of physical processes defined by domain specific laws. The basic physical processes are the under ly ing concepts and entities. They are related to other physical properties in the domain through the domain specific laws. The conservation laws govern the interactions of these basic processes, and dictate how these processes are composed in to a model. Heat transfer is one of these domains. In the domain of heat transfer, the fundamenta l law is the conservation of energy and the three basic processes are conduction, convection and radiat ion heat transfer, defined by the Fourier's law of conduct ion, the Newton's law of convection and the Stefan-Boltzmann law of radiat ion. When a temperature gradient is imposed on an object f rom its environment, instances of the basic heat transfer processes occur and their interact ion is governed by the law of conservation of energy. Th is law says that the net change of energy stored w i t h i n any bounded region of space, i.e., a cont ro l region , is equal to the net heat f low in to the region plus any internal heat generation w i th in the region. A l l mathemat ica l models, regardless of their complexity, are based on this conservation law. One way to view this conservation law is in the fo rm 1 Also called a control volume of where Q,s represent instances of basic heat transfer processes act ing on surfaces of the region or internal heat generation processes w i t h i n the region, and E represents internal energy change or energy storage w i t h i n that region. Regardless of the complexi ty of heat transfer models and the various forms in which the models appear, al l of them can be traced to this fo rm. Th is general and yet simple fo rm has two impl icat ions for the model ing process. The first imp l ica t ion is for the approx imat ion decisions. Since a model is a representat ion of this conservation law and the physical processes instant iated for a region in space, the choice of these processes w i l l affect the final fo rm of the model . Various types and number of processes can be chosen. A model representing a few physical processes is less complex. Simi lar ly, a model representing lumped processes, i.e. processes which are assumed constant w i t h respect to t ime and space, is less complex than a model representing differential processes, i.e. processes varying w i t h respect to t ime and space. In other words, the complexi ty of a model depends on the choices of processes, and a l l the approximat ions in this domain are focused on choos­ ing the types and the number of processes. A corol lary to the focus of choosing physical processes is that the model ing process is compositional at the level of physical processes. The conservation law provides a template to put an arb i t rary number of processes together once they are chosen. Processes are put in the r ight or left hand sides of the equation depending on their types. The fo rm of a model depends on the choices of physical processes. However, these processes depend on the type of a control region where the conservation law is instant iated and the type of query that a model is supposed to answer. Th is dependency constrains how model ing choices should be made. In other words, the modeling decisions and approximat ions are not to ta l ly independent of one another. Some of the decisions are constrained by earlier decisions. Th is dependency suggests a way to organize the model ing process in the fol lowing sequence. 1. F i rs t , decide on the control regions of an object. 2. For each control region, ident i fy the potent ia l act ive heat transfer and energy storage processes, and make approximat ions on them. 3. Final ly, tu rn the processes into symbols in equations, s impl i fy the equations, and provide relevant in i t ia l and boundary equations to make the models wel