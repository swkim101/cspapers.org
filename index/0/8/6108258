We present experimental results on the controlled vertical flight of a flapping-wing flying microrobot, in which for the first time an on-board sensing system is used for measuring the microrobot's altitude for feedback control. Both the control strategy and the sensing system are biologically inspired. The control strategy relies on amplitude modulation mediated by optical flow. The research presented here is a key step toward achieving the goal of complete autonomy for flying microrobots, since this demonstrates that strategies for controlling flapping-wing microrobots in vertical flight can rely on optical flow sensors.