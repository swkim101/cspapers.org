Widely-used methods for toolpath planning in fused filament fabrication slice the input 3D model into 2D layers and construct a toolpath. In prior work (ICRA 2016) we gave a simple greedy algorithm that changed this paradigm and constructed the toolpath in 3D by printing local features in their entirety. This algorithm significantly improved upon layer-based methods, achieving a 34% mean reduction of wasted motion. In this paper we give a new algorithm that is more robust and achieves significantly better performance than the greedy approach. Our algorithm utilizes local search and nearly doubles our prior improvement, achieving a mean/median reduction of 62% over layer-based methods on the same benchmark of over 400 models. We also study toolpath optimality using a novel integer linear programming formulation. This formulation allows us to solve a linear programming relaxation that, while computationally intensive, can give us a lower bound on the optimal solution quality, giving us the ability to rigorously characterize solution quality for a given input model.