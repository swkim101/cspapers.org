The autonomous capabilities of light-weight Flapping Wing Micro Air Vehicles (FWMAVs) have much to gain from onboard state estimation and attitude control. In this article, we present the first FWMAV with robust onboard state estimation and attitude control. The tailed FWMAV DelFly II was used, with the main goal to achieve active stabilization in the (passively unstable) hover condition. The attitude is estimated using an Inertial Measurement Unit with a gyroscope, accelerometer and magnetometer and the altitude is estimated using a barometer. A major challenge lies in the disturbance of the accelerometer measurements by the flapping motion of the wings. We propose a mechanical damping mechanism and flap-cycle based filtering to resolve this issue. The pitch estimates have a mean error of 1.5Â° with respect to the ground-truth measurement from a motion capture system. Using the onboard pitch estimate we can control the attitude of the FWMAV in the forward flight regime with a 30% lower standard deviation than in a trimmed flight. With a different set of gains, the FWMAV is able to perform a hovering flight - showing that a tailed FWMAV has enough control authority for this task. In a fully autonomous hover experiment, the DelFly II stays within a sphere of 0.75 m radius.