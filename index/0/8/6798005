We have implemented a collaborative agent toolkit called Collagen and used it to build a software agent that collaborates with the user of a direct-manipulation graphical interface by following the rules and conventions of human discourse. One of the main results is an interaction history that is segmented according to the structure of the agent's and user's goals, without requiring the agent to understand natural language.