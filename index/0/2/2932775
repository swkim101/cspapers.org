We consider a large-scale Ad-auction where adverts are assigned over a potentially infinite number of searches. We capture the intrinsic asymmetries in information between advertisers, the advert platform and the space of searches: advertisers know and can optimize the average performance of their advertisement campaign; the platform knows and can optimize on each search instance; and, neither party knows the distribution of the infinite number of searches that can occur. We look at maximizing the aggregate utility of the click-through rates of advertisers subject to the matching constraints of online ad allocation. We show that this optimization can be decomposed into subproblems, which occur on timescales relevant to the platform or the advertisers respectively. The interpretation of the subproblems is that advertisers choose prices which are optimal given the average click-through rate they receive, that the platform allocates adverts according to a classical assignment problem per search impression and that prices satisfy a nominal complementary slackness condition. We then place this optimization result in a game-theoretic framework by assuming that advertisers bid strategically to maximize their net benefit. In this setting, we construct a mechanism with a unique Nash equilibrium that achieves the decomposition just described, and thus maximizes aggregate utility. This simple and implementable mechanism is as follows. When a search occurs, the platform allocates advertisement slots in order to maximize the expected bid from a click-throughs - this is a classical assignment problem. If an advert receives a click, the platform then solves the assignment problem a second time with the advertiser's bid replaced by a bid which is uniformly distributed between zero and the original bid. The advertiser is then charged their bid minus a rebate. The rebate is the product of the advertiser's bid and ratio of the advertiser's click-through rate in the second assignment calculation (after a click-through) to the first assignment click-through rate (before the click-through). We demonstrate that, under the assignment and pricing mechanism just described, advertisers bidding strategically will maximize aggregate utility. The novelty of the mechanism just described is that, while maximizing utilitarian objective, it can be implemented by the platform in a strategic environment on the time-scales relevant to the platform (per-impression) and advertiser (on-average) respectively, and neither party requires information on the distribution of searches. We also show that dynamic models, where advertisers adapt their bids smoothly over time, will converge to the solution that maximizes aggregate utility.