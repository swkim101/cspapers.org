We present a general technique for detecting and counting small subgraphs. It consists in forming special linear combinations of the numbers of occurrences of different induced subgraphs of fixed size in a graph. The combinations can be efficiently computed by rectangular matrix multiplication.
 Our two main results utilizing the technique are as follows. Let <i>H</i> be a fixed graph with <i>k</i> vertices and an independent set of size <i>s</i>.
 1. Detecting if an <i>n</i>-vertex graph contains a (non-necessarily induced) subgraph isomorphic to <i>H</i> can be done in time <i>O</i>(<i>n</i><sup><i>k−s</i></sup> + <i>n</i><sup><i>w</i>(⌈(<i>k−s</i>)/2⌉,1,⌊(<i>k−s</i>)/2⌋)</sup>), where <i>w</i>(<i>p, q, r</i>) is the exponent of fast arithmetic matrix multiplication of an <i>n</i><sup><i>p</i></sup> x <i>n</i><sup><i>q</i></sup> matrix by an <i>n</i><sup><i>q</i></sup> x <i>n</i><sup><i>r</i></sup> matrix.
 2. When <i>s</i> = 2, counting the number of (non-necessarily induced) subgraphs isomorphic to <i>H</i> can be done in the same time, i.e., in time <i>O</i>(<i>n</i><sup><i>k</i>-2</sup> + <i>n</i><sup><i>w</i>(⌈(<i>k</i>-2)/2⌉,1,⌊(<i>k</i>-2)/2⌋)</sup>). (This improves for <i>s</i> = 2 on a counting algorithm of Vassilevska and Williams, running in time <i>O</i>(<i>n</i><sup><i>k-s</i>+3</sup>).)
 It follows in particular that we can count the number of subgraphs isomorphic to any <i>H</i> on four vertices that is not <i>K</i><sub>4</sub> in time <i>O</i>(<i>n</i><sup><i>w</i></sup>), where <i>w</i> = <i>w</i>(1, 1, 1) is known to be smaller than 2.376. Similarly, we can count the number of subgraphs isomorphic to any <i>H</i> on five vertices that is not <i>K</i><sub>5</sub> in time <i>O</i>(<i>n</i><sup><i>w</i>(2,1,1)</sup>), where <i>w</i> (2, 1, 1) is known to be smaller than 3.334.