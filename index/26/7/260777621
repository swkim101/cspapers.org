USB Power Delivery (USBPD) is a state-of-the-art charging protocol for advanced power supply. Thanks to its high volume of power supply, it has been widely adopted by consumer devices, such as smartphones and laptops, and has become the de facto USB charging standard in both EU and North America. Due to the low-level nature of charging and the complexity of the protocol, USBPD is often implemented as proprietary firmware running on a dedicated microcontroller unit (MCU) with a USBPD physical layer. Bugs within these implementations can not only lead to safety issues, e.g., over charging, but also cause security issues, such as allowing attackers to reflash USBPD firmware. This paper proposes F UZZ PD, the first black-box fuzzing technique with dual-role state guidance targeting off-the-shelf USBPD devices with closed-source USBPD firmware. F UZ - Z PD only requires a physical USB Type-C connection to operate in a plug-n-fuzz fashion. To facilitate the black-box fuzzing of USBPD firmware, F UZZ PD manually creates a dual-role state machine from the USBPD specification, which enables both state coverage and transitions from fuzzing inputs. F UZZ PD further provides a multi-level mutation strategy, allowing for fine-grained state-aware fuzzing with intra-and inter-state mutations. We implement F UZZ PD using a Chromebook as the fuzzing host and evaluate it against 12 USBPD mobile devices from 7 different vendors, 7 USB hubs from 7 different vendors, and 5 chargers from 5 different vendors. F UZZ PD has found 15 unique bugs, 9 of which have been confirmed by the corresponding vendors. We additionally conduct a comparison between F UZZ PD and multiple state-of-the-art black-box fuzzing techniques, demonstrating that F UZZ PD achieves code coverage that is 40% to 3x higher than other solutions. We then compare F UZZ PD with the USBPD compliance test suite from USBIF and show that F UZZ PD can find 7 more bugs with 2x higher code coverage. F UZZ PD is the first step towards secure and trustworthy USB charging.