In this paper, a comprehensive solution for enabling unmanned aerial vehicle (UAV) to autonomously fly through complex and dynamic environments is proposed. Moving objects all have unique property information, we propose a method that utilizes deep learning for 3D dynamic environment perception, while taking into account limitations in computing resources. For safer dynamic avoidance, we first model the dynamic target and integrate it into a static grid occupancy map, and then construct a gradient field based on its attribute information. To achieve autonomous UAV flight in dynamic environments, we design an adaptive planning method based on gradient optimization, which achieves significant computational savings by autonomously adjusting the planning frequency and using manually constructed gradients instead of maintaining a signed distance field (SDF). We have integrated the above approach into a customised quadrotor system and thoroughly tested it in real-world, verifying its flexibility to handle multiple objects with variable speed motion in complex enviroment.