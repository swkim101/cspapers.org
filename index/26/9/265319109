In this study, we explore the problem of optimizing throughput while maintaining energy efficiency in an Internet of Things (IoT) data collection system. The system is characterized by unique data generation rates from each IoT device, and the details of these rates are uncertain. We propose a Lyapunov drift-based deep reinforcement learning framework (LDRL) to handle mixed integer programming with uncertain arrival rates, aiming to maximise the average throughput. To demonstrate the effectiveness of our framework, we compare it to throughput-oriented and energy-oriented frameworks through a series of simulations. The simulation results show that our framework strikes an impressive balance between throughput and energy efficiency, achieving high average throughput while maintaining a moderate energy consumption rate, and we also observe that it maintains performance under a certain level of rapidly changing network environments.