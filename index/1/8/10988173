Software agents are computer programs that act on behalf of users to perform routine, tedious, and time-consuming tasks. To be useful to an individual user, an agent must be personalized to his or her goals, habits, and preferences. We have created an end-user programming system that makes it easy for users to state rules for their agents to follow. The main advance over previous approaches is that the system automatically determines conflicts between rules and guides users in resolving the conflicts. Thus, user and system collaborate in developing and managing a set of rules that embody the user's preferences for handling a wide variety of situations.