We study the optimal generation of random numbers using a biased coin in two cases: first, when the bias is unknown, and second, when the bias is known. In the first case, we characterize the functions that use a discrete random source of unknown distribution to simulate a target discrete random variable with a given rational distribution. We identify the functions that minimize the ratio of source inputs to target outputs. We show that these optimal functions are efficiently computable. In the second case, we prove that it is impossible to construct an optimal tree algorithm recursively, using a model based on the algebraic decision tree. Our model of computation is sufficiently general to encompass virtually all previously known algorithms for this problem.