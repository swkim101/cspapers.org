We present a versatile almost uniform random generator for planar embeddings of graphs (usually called \emph{maps}). This simple pseudo-algorithm is linear on average and gives in a few seconds random maps with up to one million edges or vertices. The class of planar graphs that can be obtained includes graphs of convex polyhedra (or 3-connected planar graphs) and convex irreducible triangulations (or 4-connected maximal planar graphs). Our algorithm relies on a combinatorial approach. First, new simpler compact encodings are defined using canonical unlabelled covering trees. Second, a general \emph{extraction/rejection} pseudo-algorithm is defined for composed structures. If correctly \emph{tuned} (we provide the necessary analysis for maps), it applies efficiently to a much wider class of planar graphs than previously known methods.