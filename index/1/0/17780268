This paper presents improvements done to a programming by demonstration (PbD)system in order to handle complex one and two hand manipulations. In order to do this, functional roles were added to the systems knowledge base. According to them a probability density function expressing the relationship between the manipulated objects bas been set up. Since one object can fulfill several functional roles in different contexts multiple hypothesis are considered. This enables the system to detect in a more reliable way the goals and the sub goals of a human demonstrated task. Further it is pointed out how this goals can be reached by setting up a sequence of elemental actions, how these are generated and represented symbolically. Such a representation is important in order to build up complex tasks consisting of several subtasks and skills. Finally an experimental setup is presented in which household task like laying a table, pouring a glass of water, handling work tools can be understood, learned and generalized by the PbD system.