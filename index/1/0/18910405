We describe a laboratory based capstone course in computer security for undergraduates. The course is based on a sequence of hands-on laboratory exercises for four teams of students. It emphasizes defensive tools and techniques at the expense of attacks; it also takes a network centered view where student teams set up and configure entire networks. In this paper, we describe the course, how it fits into the curriculum, and the laboratory facilities we have developed. We then present the details of some of our lab exercises, and discuss the lessons that we have learned.