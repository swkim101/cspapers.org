Standard restructuring compiler tools are based on polyhe dral algebra and cannot be used to analyze or restructure sparse matrix codes We have recently shown that tools based on relational algebra can be used to generate an e cient sparse matrix program from the corresponding dense matrix program and a speci cation of the sparse matrix for mat This work was restricted to DO ALL loops and loops with reductions In this paper we extend this approach to loops with dependences Although our results are restricted to Compressed Hyperplane Storage formats they apply to both perfectly nested loops and imperfectly nested loops