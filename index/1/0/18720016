In the present paper we introduce the notion of Variable Assignment Problem (VAP) as an abstract framework for characterizing diagnosis. Components of the system to be diagnosed are put in correspondence with variables, behavioral modes of the components are the values of the variables and a diagnosis is a variable assignment which explains the observations of the diagnostic problem, by considering the constraints put by the domain theory. In order to have a concise representation of diagnoses and to reduce the search space, we introduce the notion of scenario for representing a set of diagnoses. The paper discusses the definition of preference criteria for ranking solutions and their use for guiding the heuristic search for diagnoses. Experimental data are reported for the evaluation of such a heuristic search on a real-world diagnostic problem, concerning the identification of faults in a space robot arm; in this domain, where a high number of diagnoses may be possible, our approach allows one to get a concise representation of the large number of solutions and to define effective diagnostic strategies able to provide relevant information about fault localization and identification.