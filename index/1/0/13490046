Consider the following generalized hidden shift problem: given a function <i>f</i> on {0,..., <i>M</i> - 1} x Z<inf><i>N</i></inf> promised to be injective for fixed <i>b</i> and satisfying <i>f</i>(<i>b, x</i>) = <i>f</i>(<i>b</i> + 1,<i>x</i> + <i>s</i>) for <i>b</i> = 0, 1,..., <i>M</i> - 2, find the unknown shift <i>s</i> ε Z<inf><i>N</i></inf>. For <i>M</i> = <i>N</i>, this problem is an instance of the abelian hidden subgroup problem, which can be solved efficiently on a quantum computer, whereas for <i>M</i> = 2, it is equivalent to the dihedral hidden subgroup problem, for which no efficient algorithm is known. For any fixed positive ε, we give an efficient (i.e., poly(log <i>N</i>)) quantum algorithm for this problem provided <i>M</i> ≥ <i>N</i><sup>ε</sup>. The algorithm is based on the "pretty good measurement" and uses H. Lenstra's (classical) algorithm for integer programming as a subroutine.