We present a nearly-linear time approximation algorithm for uncapacitated minimum-cost flow in undirected graphs, along with a more general framework for approximately solving problems of the form: find x satisfying Ax = b with minimal norm ||x||, where the norm is generally non-Euclidean. For most of the extensive applications of the latter problem, the exact constraints are essential, so an x satisfying Ax = b with almost-minimal norm is acceptable, while relaxing Ax = b to Ax ≈ b significantly beyond numerical precision is not. On the other hand, existing nearly-linear time solvers for non-Euclidean norms use dual or penalty methods, yielding the opposite notion where ||x|| is minimal while ||b − Ax|| ≤ t−Ω(1) after t iterations. We show that by composing solvers of the latter type, we may obtain solvers of the more-useful former type. Convergence of the composed solvers depends strongly on a generalization of the classical condition number to general norms. Following our framework, the task of the algorithm designer for such problems is reduced to that of designing a generalized preconditioner for A. Applying the framework to uncapacitated minimum-cost flow, we present an algorithm that, given an undirected graph with m edges labelled with costs, and n vertices labelled with demands, takes ϵ−2m1+o(1)-time and outputs a flow routing the demands with total cost at most (1 + ϵ) times larger than minimal, along with a dual solution proving near-optimality. The generalized preconditioner is obtained by embedding the cost metric into l1, and then considering a simple hierarchical routing scheme in l1 where demands initially supported on a dense lattice are pulled from a sparser lattice by randomly rounding unaligned coordinates to their aligned neighbors. Analysis of the generalized condition number for the corresponding preconditioner follows that of the classical multigrid algorithm for lattice Laplacian systems.