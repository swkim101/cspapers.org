High Performance Fortran (HPF) is a candidate for a standard programming language for distributed memory parallel computers. This paper presents the design and implement ation of an HPF compiler for the Fujitsu AP1OOO parallel computers. There are two novel features implemented in the compiler. The first is a machine-independent optimization based on the intermediate format. The second is a code generation technique utilizing the direct remote data access (DRDA) mechanism and stride data transfer supported by the AP1OOO hardware. With the results of experiments on the AP1OOO, this paper shows the effects of the optimization and code generation techniques.