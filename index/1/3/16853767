Today’s complex production systems allow to si- multaneously build different products following in- dividual production plans. Such plans may fail due to component faults or unforeseen behavior, result- ing in flawed products. In this paper, we propose a method to integrate diagnosis with plan assessment to prevent plan failure, and to gain diagnostic in- formation when needed. In our setting, plans are generated from a planner before being executed on the system. If the underlying system drifts due to component faults or unforeseen behavior, plans that are ready for execution or already being executed are uncertain to succeed or fail. Therefore, our ap- proach tracks plan execution using probabilistic hi- erarchical constraint automata (PHCA) models of the system. This allows to explain past system be- havior, such as observed discrepancies, while at the same time it can be used to predict a plan’s re- maining chance of success or failure. We propose a formulation of this combined diagnosis/assessment problem as a constraint optimization problem, and present a fast solution algorithm that estimates suc- cess or failure probabilities by considering only a limited number k of system trajectories.