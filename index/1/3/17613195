The impedance shaping control with robot base dynamics compensation is presented in this paper. The method has been conceived to avoid force overshoots in applications where the coupled dynamics of the global system (compliant robot base - controlled robot - interacting compliant environment) affects the force tracking task. Force tracking performance are obtained tuning on-line both the position set-point and the stiffness and damping parameters, based on the force error, the estimated stiffness of the interacting environment (an Extended Kalman Filter is used) and the estimated robot base position (a Kalman Filter is used). The stability of the presented strategy has been studied through Lyapunov. To validate the performance of the control an assembly task is taken into account, considering the geometrical and mechanical properties of the (partially) unknown environment. Results are compared with constant stiffness and damping impedance controllers, which show force overshoots and instabilities.