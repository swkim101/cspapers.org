The objective of this paper is to present the model-based 3D object recognition and fetching by a 7-DoF robot with online obstacle avoidance for factory automation. The robot can fetch the random type of 3D objects with arbitrary pose using a 3D visual camera. Object recognition pipeline based on different descriptors are compared in order to decide the best choice for this scenario. A correct grasp is taught by human operator using programming by touch. As a result, the time of configuring and setting up the robot drastically decreases and thus saves a large amount of preparation time before the robot can actually get to work. Considering the safety issue of the human operators that cooperate with the robot, as well as the uncertainty of the environment such that a moving obstacle might present, or the environment might change for some reason, an online obstacle avoidance algorithm is also integrated into the system. Experimental proof of principles has been successfully implemented.