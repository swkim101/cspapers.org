We consider the problem of online scheduling of jobs on unrelated machines with dynamic speed scaling to minimize the sum of energy and weighted flow-time. We give an algorithm with an almost optimal competitive ratio for arbitrary power functions. (No earlier results handled arbitrary power functions for unrelated machines.) For power functions of the form f(s) = sα for some constant α > 1, we get a competitive ratio of O(α / log α), improving upon a previous competitive ratio of O(α2) by Anand et al. (2012), along with a matching lower bound of Ω(α / log α). Further, in the resource augmentation model, with a 1+ ε speed up, we give a 2(1/ε + 1) competitive algorithm, with essentially the same techniques, improving the bound of 1 + O(1/ε2) by Gupta et al. (2010) and matching the bound of Anand et al. (2012) for the special case of fixed speed unrelated machines. Unlike the previous results most of which used an amortized local competitiveness argument or dual fitting methods, we use a primal-dual method, which is useful not only to analyze the algorithms but also to design the algorithm itself.