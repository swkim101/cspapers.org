We present Castalia, a simulator for WSN that models many aspects of the WSN system and uses advanced models especially in terms of the channel and radio behaviour. We show the effects of these features in distributed algorithms that work fine with simpler simulators but fail under Castalia. The demo will present the differences, explain the failures and show how to redesign the algorithms to make them work under more realistic conditions.