Current data centers often adopt conservative and static settings for cooling and air circulation systems, leading to excessive energy consumption. This paper presents the design and evaluation of PTEC -- a system for predictive thermal and energy control in data centers. PTEC leverages the server built-in sensors and monitoring utilities, as well as a wireless sensor network, to monitor both the cyber and physical status of a data center. By predicting the temperature evolution of a data center in real time, PTEC finds the temperature set points, the cold air supply rates, and the speeds of server internal fans to minimize the expected total energy consumption of cooling and circulation systems. Moreover, PTEC enforces the upper bounds on server inlet temperatures and their temporal variations to prevent server overheating and reduce server hardware failure rate. We evaluated PTEC on a hardware test bed consisting of 15 servers and a total of 23 temperature and power sensors, as well as through Computational Fluid Dynamics (CFD) simulations based on real data traces collected from a data center with 229 servers. The experimental results show that PTEC can reduce the cooling and circulation energy consumption by more than 30%, compared with baseline thermal control strategies.