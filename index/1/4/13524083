We present a holistic architecture for energy management in sensor networks. Our architecture is based on a model-driven approach which attempts to (a) establish functional relationships across different components of the software stack and the interrelated parameters based on empirical data, (b) use the maximum sensor value and time-synchronization errors acceptable by the users of the sensor network application as input to establish minimum quality of service requirements, and (c) optimize the parameter values of all the software modules within the node's application stack to minimize total energy consumption for each sensor node. We explore the trade-offs of the design space by using a non-trivial application that includes sensing, time synchronization and routing modules and show that when using our architecture, we can provide energy savings in the average of 37% to 76% while still maintaining quality of service both in terms of the expected sensing and time-synchronization errors. We further show that even when using modules that perform significantly better than others with default values (e.g. ORW >> CTP), we can still reduce overall energy consumption by properly adjusting the parameters of lowest performance modules and provide energy savings in the average of 30% to 43%.