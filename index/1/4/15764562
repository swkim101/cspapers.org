In this paper, we introduce the concept of optimal degree of parallelism into both individual operation and single query level, and present a subtree-grouping method, SCM, to search the optimal processor assignment. By making use of the introduced concept and SCM, an optimised processor assignment algorithm, OPA, is developed by employing both intra and inter operation parallelism. OPA provides a global optimal solution when the number of processors is sufficient and a local phase optimisation in all other situations. The new algorithm is able to perform adaptively based on two methods; dynamic processor assignment method where the optimal number of processors are allocated to operations during processing, and merge-point-oriented phase partitioning method where operations are grouped into execution phases evenly based on the heuristic of merge point evaluation. The new algorithm is evaluated by a simulation study together with the existing algorithms. The results show that the new algorithm always gives the best performance based on a large number of queries in five different query groups.