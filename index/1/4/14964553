A novel heat kernel based Monte Carlo localization (HK-MCL) algorithm is presented to solve the degeneracy problem of conventional Monte Carlo localization: real-time global localization requires the number of initial samples to be small, whereas global localization may fail if the number of initial samples is small. The degeneracy problem is solved by an optimization approach called heat kernel based perturbation (HK-perturbation), which moves the samples towards the high likelihood area. HK-perturbation integrates the average local density and importance weight of samples to determine each sample's perturbation probability. The strategy improves simulated annealing algorithm via an obvious form of temperature, both in time and space, with respect to average local density and importance weight of samples. Systematic empirical results in global localization based on sonar illustrate superior performance, when compared to other state-of-the-art updating of Monte Carlo localization.