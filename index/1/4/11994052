Per-hop authentication is the most effective way to prevent DOS attacks during multihop data delivery. Although the study results show that Public Key Cryptography (PKC) is feasible on sensor nodes with limited resources, it is still very expensive to perform per-hop authentication using public key digital signature. To solve the problem that the resources of WSN is exhausted quickly by PKC, Dynamic Window Based Multihop Authentication(DWMA) for WSN is proposed in this paper. Dynamic window makes it possible to pay only a small number of authentication based on digital signature for confining DoS attacks effectively in a small scope and locating suspicious nodes quickly. Experimental results show that DWMA could save more resources than per-hop authentication for WSN, defend DoS attacks effectively and locate malicious nodes. It's an effective protocol for ensuring the resistance of DoS in routing.