Ubiquitous computing promotes flexibility for the enduser. This means that some design choices have to be shifted from design-time to run-time in order to involve the end-user into the decision process. In this paper, we study flexible plans, i.e. plans that let the end-user arrange tasks planned by an automated process seeking to achieve his needs. More precisely, we present an algorithm -graphplan that lets the end-user to decide the order of specific treatments (loop body) execution to a set of objects (loop variants). -graphplan is based on graph planning structure. Its strength is that it does not require any problemdependent knowledge to compute flexible plans. By relaxing mutex constraints in the planning graph, - graphplan discovers the loop variants and builds the macro-actions that constitute the loop bodies. We show that -graphplan is performant with "iterative" as well as with "linear" domains.