We present a new algorithm for state assignment designed for use with multi-level logic optimization algorithms. The algorithm encodes states to select good common factors (kernels) in the final combinational logic. Encoding is performed on a programmable-encoding machine model, which models state codes as machine inputs and allows logic optimization algorithms to be performed directly on the unencoded logic. We discuss our experiments with the algorithm and with other methods of state assignment.