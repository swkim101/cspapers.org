Online sandbox services provide an effective method for Internet users to identify suspicious programs rapidly via automated analysis reports. However, malware authors have already developed corresponding countermeasures to evade analysis. The improved malware can behave similar to normal programs or exit processes immediately when they detect that they are running inside sandbox environments. Our experiments show that most publicly available sandbox services have specific fingerprints thus can be detected easily. To rectify this problem, we propose a fingerprints randomization methodology that exploits hook techniques to defeat sandbox-aware malware. We implement the proposed techniques based on the Cuckoo sandbox, and demonstrate that it can effectively defeat sandbox-aware malware.