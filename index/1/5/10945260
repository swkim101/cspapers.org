Fluid-mediated programmable stochastic self-assembly offers promising means to formation of target structures capable of a variety of functionalities. While miniaturized building blocks allow for finer resolutions in such structures, as well as access to unconventional environments, they can only be endowed with very limited on-board resources. In this paper we present the design, fabrication, and experimental results validating the key functionalities of the Lily robot as the building block in a programmable stochastic fluidic self-assembly system, capable of forming 2D structures. In particular, we aim at driving a system including an arbitrary number of Lilies to form target structures through parallel self-assembly, using exclusively local information and communication. While capable of wireless communication to a base station, Lilies are endowed with custom-designed electropermanent magnets to latch and also to communicate locally with their neighbors. Several experiments validate the reliability of the radio channel as well as the robustness of the local induction-based communication which allows for data transfer at 9600 bps with a success rate of 92.8% without repetition. The latches are shown to hold four times the weight of a single robot and to drag in another Lily from a distance of 4 mm in water.