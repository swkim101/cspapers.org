In this paper, we consider two-sided, many-to-one matching problems where agents in one side of the market (schools) impose some distributional constraints (e.g., a maximum quota for a set of schools), and develop a strategyproof mechanism that can handle a very general class of distributional constraints. We assume distributional constraints are imposed on a vector, where each element is the number of contracts accepted for each school. The only requirement we impose on distributional constraints is that the family of vectors that satisfy distributional constraints must be hereditary, which means if a vector satisfies the constraints, any vector that is smaller than it also satisfies them. When distributional constraints are imposed, a stable matching may not exist. We develop a strategyproof mechanism called Adaptive Deferred Acceptance mechanism (ADA), which is nonwasteful and "more fair" than a simple nonwasteful mechanism called the Serial Dictatorship mechanism (SD) and "less wasteful" than another simple fair mechanism called the Artificial Cap Deferred Acceptance mechanism (ACDA). We show that we can apply this mechanism even if the distributional constraints do not satisfy the hereditary condition by applying a simple trick, assuming we can find a vector that satisfy the distributional constraints efficiently. Furthermore, we demonstrate the applicability of our model in actual application domains.