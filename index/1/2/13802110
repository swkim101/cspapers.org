Over the past few years, ride-sharing has been proven to be an effective way to relieve urban traffic congestion, as evidenced by several emerging ride-sharing platforms such as Uber and Didi. A key economic problem for these platforms is to design a revenue-optimal (or welfare-optimal) pricing scheme and a corresponding vehicle dispatching policy that incorporates geographic information, and more importantly, dynamic supply and demand. In this paper, we aim to solve this problem by introducing a unified model that takes into account both travel time and driver redirection. We tackle the non-convexity problem using the "ironing" technique and formulate the optimization problem as a Markov decision process (MDP), where the states are the driver distributions and the decision variables are the prices. Our main finding is to give an efficient algorithm that computes the exact revenue (or welfare) optimal randomized pricing schemes. We characterize the optimal solutions of the MDP by primal-dual analysis of a convex program. We also conduct empirical analysis of our solution with real data of a major ride-sharing platform and show its significant advantages over fixed pricing schemes as well as those prevalent surge-based pricing schemes.