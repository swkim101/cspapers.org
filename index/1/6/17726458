We give efficient randomized schemes to sample and approximately count Eulerian orientations of any Eulerian graph. Eulerian orientations are natural flow-like structures, and Welsh has pointed out that computing their number (i)corresponds to evaluating the Tutte polynomial at the point (0, –2) [8,19] and (ii) is equivalent to evaluating “ice-type partition functions” in statistical physics [20].
Our algorithms are based on a reduction to sampling and approximately counting perfect matchings for a class of graphs for which the methods of Broder [3, 10] and others [4, 6] apply. A crucial step of the reduction is the “Monotonicity Lemma” (Lemma 3.3) which is of independent combinatorial interest. Roughly speaking, the Monotonicity Lemma establishes the intuitive fact that “increasing the number of constraints applied on a flow problem can only decrease the number of solutions”. In turn, the proof of the lemma involves a new decomposition technique which decouples problematically overlapping structures (a recurrent obstacle in handling large combinatorial populations) and allows detailed enumeration arguments. As a byproduct, (i) we exhibit a class of graphs for which perfect and near-perfect matchings are polynomially related, and hence the permanent can be approximated, for reasons other than “short augmenting paths” (previously the only known approach); and (ii) we obtain a further direct sampling scheme for Eulerian orientations which is faster than the one suggested by the reduction to perfect matchings.
Finally, with respect to our approximate counting algorithm, we give the complementary hardness result, namely, that counting exactly Eulerian orientations is #P-complete, and provide some connections with Eulerian tours.