The objective of this work is to model a switched Ethernet architecture in order to be able to evaluate the maximum end to end delays. The major interest is to apply these results in an industrial or technical context, where some of the communications are strongly time-constrained. In this paper, we have chosen the network calculus theory, because it enables a good representation of the exchanges between the equipment which are connected to the network, and also to determine the maximum end to end delays. Previous models presented are improved in order to take into account the implementation of a classification of service (CoS) mechanism which enables to define priorities for the messages regarding the time constraints they have to respect This paper describes a new model of a IEEE 802.1p switch. It also presents the analytical formulas which upper bound the maximum time for crossing such a switch, and an algorithm to determine the maximum end to end delays of the time-critical messages over the whole network. A typical application shows the interest of this approach