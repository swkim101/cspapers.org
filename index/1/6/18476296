It has argued that systems for detecting similarities in submitted programs must be based on the analysis of program structure. One such system is “Plague”. In this paper, some difficulties with the Plague system are outlined and a new system is described that achieves the same goals as Plague, but in a way that is both more portable and more easily customized to new target languages.