This paper describes a middleware which the authors developed to implement distributed sensor networks. The authors have been developing sensorized environments which have hundreds of sensors and can monitor human daily activities in real time. All sensors in the environment should be connected and organized into a sensor network because no single sensor can cover the whole environment. The middleware developed by the authors supports easy implementation of such sensor network. The design and implementation of the middleware, especially the generic programming and pattern-oriented approach for I/O device handlers, are presented in this paper.