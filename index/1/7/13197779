The commercial viability of the future Internet depends on its ability to provide differentiated service to paying customers. The existing Internet delivers only the socalied best effort (undifferentiated) service. Examples of differentiated service include firewalls for enterprise networks, bandwidth guarantees to applications, and traffic sensitive routing. These services require Internet routers to move from simple destination-based packet forwarding to a more complex form of forwarding called layer 4 switching. In layer 4 switching, each router maintains a database of packet filters, each specifying values for some key header fields. The most common fields are the IP destination address (32 bits), IP source address (32 bits), protocol type (8 bits), and port numbers (16 bits) of destination and source applications. Each field is specified as a variable length prefix. For instance, the filter F = (128.112 A, *, TCP, 20, *) specifies a rule for tra& flow addressed to subnet 128.112 using TCP destination port 20, which is typically used for file transfer; a firewall database may disallow file transfers into its network. (The symbol * denotes the standard wild card character.)