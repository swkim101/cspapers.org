The problem of counting homomorphisms from a general graph G to a fixed graph H is a natural generalisation of graph colouring, with important applications in statistical physics. The problem of deciding whether any homomor-phism exists was considered by Hell and Ne~et[il. They showed that decision is NP-complete unless H has a loop or is bipartite; otherwise it is in P. We consider the problem of exactly counting the number of such homomorphisms, and give a similarly complete characterisation. We show that counting is ~P-complete unless every connected component of H is an isolated vertex without a loop, a complete graph with all loops present, or a complete unlooped bipar-tite graph; otherwise it is in P. We prove further that this remains true when G has bounded degree. In particular, our theorems provide the first proof of #P-completeness of the partition function of certain models from statistical physics, such as the Widom-Rowlinson model, even in graphs of maximum degree 3. Our results are proved using a mixture of spectral analysis and interpolation and combinatorial arguments .