We use a hierarchical partition of unity finite element method (H-PUFEM) to represent and analyse the non-rigid deformation fields involved in multidimensional image registration. We make use of the Ritz-Galerkin direct variational method to solve non-rigid image registration problems with various deformation constraints. In this method, we directly seek a set of parameters that minimizes the objective function. We thereby avoid the loss of information that may occur when an Euler-Lagrange formulation is used. Experiments are conducted to demonstrate the advantages of our approach when registering synthetic images having little of or no localizing features. As a special case, conformal mapping problems can be accurately solved in this manner. We also illustrate our approach with an application to cardiac magnetic resonance temporal sequences.