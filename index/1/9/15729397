We consider a weighted proportional allocation of resources that allows providers to discriminate usage of resources by users. This framework is a generalization of well-known proportional allocation by accommodating allocation of resources proportional to weighted bids or proportional to submitted bids but with weighted payments.
 We study a competition game where everyone is selfish: providers choose user discrimination weights aiming at maximizing their individual revenues while users choose their bids aiming at maximizing their individual payoffs. We analyze revenue and social welfare of this game. We find that the revenue is lower bounded by k/(k+1) times the revenue under standard price discrimination scheme, where a set of k users is excluded. For users with linear utility functions, we find that the social welfare is at least 1/(1+2/âˆš3) of the maximum social welfare (approx. 46%) and that this bound is tight. We extend this efficiency result to a broad class of utility functions and multiple competing providers. We also describe an algorithm for adjusting discrimination weights by providers without a prior knowledge of user utility functions and establish convergence to equilibrium points of the competition game.
 Our results show that, in many cases, weighted proportional sharing achieves competitive revenue and social welfare, despite the fact that everyone is selfish.