The watershed algorithm has many nice properties in terms of robustness to image noise, topology, and effective handling non-rigid deformations. It also has drawbacks including oversegmentation and lack of regularization. We present new methods to overcome these drawbacks. We propose a novel region merging algorithm based on the water diffusion principle. Starting with a large number of markers, lakes formed around the markers are merged in the order they meet during the immersion. The merging is not performed immediately but delayed until the amount of water diffusion between two lakes is significant enough to overwhelm the small lake. The delay makes the merging result robust to "leaks" in object boundaries, when weak edges could trigger the merging of object into the background as in traditional methods. Regularization is achieved by imposing priors of local shape configurations. Local shape features are extracted from Gaussian derivatives of the object indicator function. The ensemble of shape features at multiple scales increases representation power. These features are used to incorporate smoothness and domain knowledge into the evolution of region boundaries in the watershed algorithm. The method has been successfully applied to segmentation of worms.