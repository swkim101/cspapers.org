We consider the solvability of the equation and generalizations, where the A{sub i} and B are given commuting matrices over an algebraic number field F. In the semigroup membership problem, the variables x{sub i} are constrained to be nonnegative integers. While this problem is NP-complete for variable k, we give a polynomial time algorithm if k is fixed. In the group membership problem, the matrices are assumed to be invertible, and the variables x{sub i} may take on negative values. In this case we give a polynomial time algorithm for variable k and give an explicit description of the set of all solutions (as an affine lattice). The special case of 1 x 1 matrices was recently solved by Guoqiang Ge; we heavily rely on his results.