This paper presents a new on-line planner for dynamic environments that is based on the concept of Velocity Obstacles (VO). It addresses the issue of motion safety, i.e. avoiding states of inevitable collision, by selecting a proper time horizon for the velocity obstacle. The proper choice of the time horizon ensures that the boundary of the velocity obstacle coincides with the boundary of the set of inevitable collision states. This time horizon is determined by the minimum time it would take the robot to avoid collision, either by stopping or by passing the respective obstacle. The planner generates a near-time optimal trajectory to the goal by selecting at each time step the velocity that minimizes the time-to-go and is out of the velocity obstacle. The planner takes into account the shape, velocity, and path curvature of the obstacle's trajectory. It is demonstrated for on-line motion planning in very crowded static and dynamic environments.