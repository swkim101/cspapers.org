This paper presents PipeProbe, a mobile sensor system for determining the spatial topology of hidden water pipelines behind walls. PipeProbe works by dropping a tiny wireless sensor capsule into the source of the water pipelines. As the PipeProbe capsule traverses the pipelines, it gathers and transmits pressure and angular velocity readings. Through spatio-temporal analysis on the sensor readings, our algorithm locates all turning points in the pipelines and maps their 3D spatial topology. We evaluated the PipeProbe system by developing a prototype and using data collected in our experimental testbed. Results show that the PipeProbe system successfully located and estimated 90% of all pipe tube lengths within 8-cm accuracy on average tube lengths of 76 cm. PipeProbe also successfully located 90% of all turning points within 15-cm accuracy on average length paths of 335cm.