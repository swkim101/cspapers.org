We present a system for 2D robot mapping which is entirely based on line segment representation of the environment. The system consists of multiple modules, i.e. scan number reduction, global scan alignment, scan merging and segment-error filtering, which give an example of the simplicity of mid level data processing and the advanced possibilities opened by segment based design. The compact segment representation enables creation and optimization of a global pose graph for scan registration, which is the core of the mapping system. Experiments verify the applicability to real world data sets and lead to very compact maps, which represent single linear features, e.g. walls, with single line segments.