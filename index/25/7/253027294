Motivated by applications in cloud computing spot markets and selling banner ads on popular websites, we study the online resource allocation problem with costly buyback. To model this problem, we consider the classic edge-weighted fractional online matching problem with a tweak, where the decision maker can recall (i.e., buyback) any fraction of an offline resource that is pre-allocated to an earlier online vertex; however, by doing so not only the decision maker loses the previously allocated reward (which equates the edge-weight), it also has to pay a non-negative constant factor f of this edge-weight as an extra penalty. Parameterizing the problem by the buyback factor f, our main result is obtaining optimal competitive algorithms for all possible values of f through a novel primal-dual family of algorithms. We establish the optimality of our results by obtaining separate lower-bounds for each of small and large buyback factor regimes, and showing how our primal-dual algorithm exactly matches this lower-bound by appropriately tuning a parameter as a function of f. The optimal competitive ratio Γgen(f) and the optimal competitive ratio Γdet-int(f) of deterministic integral algorithms are as follows, [EQUATION] where W−1 : [−1/e, 0) → (−∞, −1] is the non-principal branch of the Lambert W function.