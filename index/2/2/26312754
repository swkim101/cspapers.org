We propose a new pen-based text input method, which is an integration of software keyboards, handwriting recognition, and marking menus. With our method, a user selects a word from a list of candidate words filtered from a dictionary by specifying spelling, pronunciation, or the shape of its characters. Users can easily switch between using a software keyboard and using handwriting recognition systems, by tapping or writing strokes in the same area. Users can also show a menu of candidate words around the pen by stopping pen movement during operation.