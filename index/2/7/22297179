Molecular dynamics (MD) simulation has long been recognized as a potentially transformative tool for understanding the behavior of proteins and other biological macromolecules, and for developing a new generation of precisely targeted drugs. Many biologically important phenomena, however, occur over timescales that have previously fallen far outside the reach of MD technology. We have constructed a specialized, massively parallel machine, called Anton, that is capable of performing atomic-level simulations of proteins at a speed roughly two orders of magnitude beyond that of the previous state of the art. The machine has now simulated the behavior of a number of proteins for periods as long as two milliseconds -- approximately 200 times the length of the longest such simulation previously published -- revealing aspects of protein dynamics that were previously inaccessible to both computational and experimental study. The speed at which Anton performs these simulations is in large part the result of a tightly coupled codesign process in which the machine architecture was developed in concert with novel algorithms, including an asymptotically optimal parallel algorithm (with highly attractive constant factors) for the range-limited N-body problem.