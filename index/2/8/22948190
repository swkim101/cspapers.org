This paper presents a COM trajectory generation method for 3D walking and skating motion by nonlinear optimization. In our method, we solve the following problems: (1) dealing with both walking and skating motion in the same framework, (2) generating center of mass (COM) trajectory faster than execution time, (3) executing motion with large acceleration. For solving (1) and (2), we calculate the COM trajectory at every step and introduce frictional constraints to the Divergent Component of Motion as terminal conditions. By changing the terminal condition, we can generate both skating and walking motion. Besides, the nonlinear constrained optimization using Gauss Pseudospectral Method is introduced for solving (2) and (3). Thanks to this method, we generate the 3D COM trajectory considering contact constraints and kinematic constraints faster than execution time. Finally, the walking and skating experiment were carried out to confirm the effectiveness of our method using life-sized humanoid HRP-2. Applying the proposed method, HRP-2 could successfully walk at 0.4 [m/s] and skate at 1.0 [m/s].