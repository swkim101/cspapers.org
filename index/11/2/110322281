To analyze the impact of components operating environment and micro-grid on the distribution network reliability evaluation, the characteristics of components failure rate changes with operation condition are researched, and the full life cycle of the time-varying failure rate model of non-power components is built; reliability model for co-generation of hybrid, photovoltaic and energy storage system is introduced, as the power output of photovoltaic and hybrid generation is stochastic; the reliability of modified IEEE RBTS is evaluated by the built model and sequential Monte Carlo simulation method after load failure effect table is established by the reachability analysis method, the application of the proposed method to calculation example verifies its effectiveness by comparing and analyzing the reliability indices in different situations.