—The 5G mobile telephony standards are nearing completion; upon adoption these will be used by billions across the globe. Ensuring the security of 5G communication is of the utmost importance, building trust in a critical component of everyday life and national infrastructure. We perform ﬁne-grained formal analysis of 5G’s main authentication and key agreement protocol (AKA), and provide the ﬁrst models to explicitly consider all parties deﬁned by the protocol speciﬁcation. Our analysis reveals that the security of 5G-AKA critically relies on unstated assumptions on the inner workings of the underlying channels. In practice this means that following the 5G-AKA speciﬁcation, a provider can easily and ‘correctly’ implement the standard insecurely, leaving the protocol vulnerable to a security-critical race condition. We provide the ﬁrst models and analysis considering component and channel compromise in 5G, whose results further demonstrate the fragility and subtle trust assumptions of the 5G-AKA protocol. We propose formally veriﬁed ﬁxes to the encountered issues, and have worked with 3GPP to ensure these ﬁxes are adopted.