Let <tex>$\Phi=(V, \mathcal{C})$</tex> be a constraint satisfaction problem on variables <tex>$v_{1}, \ldots, v_{n}$</tex> such that each constraint depends on at most <tex>$k$</tex> variables and such that each variable assumes values in an alphabet of size at most [<tex>$q$</tex>]. Suppose that each constraint shares variables with at most <tex>$\Delta$</tex> constraints and that each constraint is violated with probability at most <tex>$p$</tex> (under the product measure on its variables). We show that for <tex>$k, q=O(1)$</tex>, there is a deterministic, polynomial time algorithm to approximately count the number of satisfying assignments and a randomized, polynomial time algorithm to sample from approximately the uniform distribution on satisfying assignments, provided that <tex>$C\cdot q^{2}\cdot k\cdot p\cdot\Delta^{7} < 1$</tex>, where <tex>$C$</tex> is an absolute constant. Previously, a result of this form was known essentially only in the special case when each constraint is violated by exactly one assignment to its variables. For the special case of <tex>$k$</tex> .CNF formulas, the term <tex>$\Delta^{7}$</tex> improves the previously best known <tex>$\Delta^{60}$</tex> for deterministic algorithms [Moitra, J.ACM, 2019] and <tex>$\Delta^{13}$</tex> for randomized algorithms [Feng, Guo, Yin, and Zhang, STOC 2021]. For the special case of properly <tex>$q$</tex>-coloring <tex>$k$</tex>-uniform hypergraphs, the term <tex>$\Delta^{7}$</tex> improves the previously best known <tex>$\Delta^{14}$</tex> for deterministic algorithms [Guo, Liao, Lu, and Zhang, SICOMP, 2019] and <tex>$\Delta^{9}$</tex> for randomized algorithms [Feng, Guo, Yin, and Zhang, STOC 2021].