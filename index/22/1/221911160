The variety of smart devices and their communication models increase the development complexity of embedded software for IoT. Thus, the development of these systems becomes more error-prone, complex, and costly. To tackle this problem, in this study, a model-driven approach is proposed for the development of RIOT-OS based IoT systems. To this end, a meta-model is designed for RIOT-OS. Based on this meta-model, a Domain-specific Modeling Language (DSML) is developed to graphically represent the domain models. To gain more functionality for the language, domain rules are defined as constraints. Also, system codes are generated partially from the instance models. In this way, the development is supported by code synthesis and the number of bugs is reduced. Finally, a smart irrigation system and a smart lighting system are implemented to evaluate the proposed DSML. The results show that about 83.5% of the final code is generated automatically on average.