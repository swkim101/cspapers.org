With the aim of developing a lightweight yet accurate network security method for Internet of Things, this paper presents the neural-network-based intrusion detection model that incorporates a parameter trimming method. The intrusion detection and classification function is implemented on programmable data plane, thus significantly reducing the detection time. Moreover, by using the neuron pruning approach, the proposed architecture requires a much lower delay for traffic classification with a slight reduction in classification accuracy. We conduct experiments using a P4 programming language and the collected results show that the pruned intrusion detection model with low model complexity is more feasible for edge devices with constrained computing and memory resources than the fully-connected model.