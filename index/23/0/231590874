—An emerging trend in network security consists in the adoption of programmable switches for performing various security tasks in large-scale, high-speed networks. However, since existing solutions are tailored to speciﬁc tasks, they cannot accommodate a growing variety of ML-based security applications, i.e., security-focused tasks that perform targeted ﬂow classiﬁcation based on packet size or inter-packet frequency distributions with the help of supervised machine learning algorithms. We present FlowLens, a system that leverages programmable switches to efﬁciently support multi-purpose ML-based security applications. FlowLens collects features of packet distributions at line speed and classiﬁes ﬂows directly on the switches, enabling network operators to re-purpose this measurement primitive at run-time to serve a different ﬂow classiﬁcation task. To cope with the resource constraints of programmable switches, FlowLens computes for each ﬂow a memory-efﬁcient representation of relevant features, named “ﬂow marker”. Despite its small size, a ﬂow marker