Despite plenty of motion planning strategies have been proposed for bipedal locomotion, enhancing the walking robustness in real-world environments is still an open question. This paper focuses on robust body and leg trajectories synthesis through integrating constrained optimization with imitation learning. Specifically, we first propose a Quadratically Constrained Quadratic Programming (QCQP) algorithm to make use of the ankle strategy and stepping strategy. Based on the Linear Inverted Pendulum (LIP) model, body motion can be determined by the modulated Center of Pressure (CoP) position and step parameters (including step location and step duration). After that, we exploit an imitation learning approach Kernelized Movement Primitives (KMP) to plan robot leg motions, which allows for adapting the learned motion patterns to new situations (e.g., passing through various desired points) in a straightforward manner. Several LIP simulations and whole-body dynamic simulations demonstrate that higher walking robustness can be achieved using our framework.