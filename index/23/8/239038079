We consider the problem of rearranging objects in a cluttered and confined space using a robotic manipulator. The goal is to retrieve a target object from the clutter where the target is occluded by other objects. In situations where overhand grasps are not allowed, the robot needs to remove some objects to make the target accessible. In the course of removing the objects, the robot also needs to determine the locations to place the removed objects. If the robot can access enough empty spaces around or inside the clutter, the placement of the objects is trivially simple. If empty spaces are scarce, placing objects should be done in a principled way as an incorrect placement would deplete the empty spaces quickly.In this work, we propose a method that solves the problems of what and where to relocate objects inside the clutter to retrieve the target. Previously, there have been several efficient methods proposed that deal with each of the what and where to relocate problems separately. We solve the problems together using a graph structure constructed from an object configuration. Also, the method runs fast so scalable in the number of objects. Compared to a state-of-the-art method, our method reduces task and motion planning time up to 74.9% (at least 56.7%) and has a higher success rate under a short time limit for planning, which is 3 minutes.