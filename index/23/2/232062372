The network technology plays an important role in the emerging industry 4.0. Industrial control systems (ICS) are related to all aspects of human life and have become the target of cyber-attackers. Attacks on ICS may not only cause economic loss, but also damage equipment and hurt staff. The biggest challenges in establishing a secure network communication system is how to effectively detect and prevent malicious network behavior. A Network Intrusion Detection System (NIDS) can be deployed as a defense mechanism for cyberattacks. However, for industrial internet-of-things (IIoT) applications with limited computing resources, designing an effective NIDS is challenging. In this paper, we propose to use machine learning as the core technology to build a compact and effective NIDS for IIoT. The proposed method is validated by using the more recent UNSW-NB 15 dataset to improve the detection capability against new types of attacks in the real world. Furthermore, we demonstrate that the method is also valid for traditional KDD-CUP-99 dataset. Experimental results show that the proposed method achieves better performance than previous methods.