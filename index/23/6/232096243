YARA is the industry standard to search for patterns in malware data sets. Malware analysts heavily rely on YARA rules to identify speciﬁc threats, e.g., by scanning unknown malware samples for patterns that are characteristic for a certain malware strain. While YARA is tremendously useful to in-spect individual ﬁles, its run time grows linearly with the number of input ﬁles, resulting in prohibitive performance penalties in large malware corpora. We present Y AR I X , a methodology to efﬁciently reveal ﬁles matching arbitrary YARA rules. In order to scale to large malware corpora, Y AR I X uses an inverted n -gram index that maps ﬁxed-length byte sequences to lists of ﬁles in which they appear. To efﬁciently query such corpora, Y AR I X optimizes YARA searches by transforming YARA rules into index lookups to obtain a set of candidate ﬁles that potentially match the rule. Given the storage demands that arise when indexing binary ﬁles, Y AR I X compresses the disk footprint with variable byte delta encoding, abstracts from ﬁle offsets, and leverages a novel grouping-based compression methodology. This completeness-preserving approximation will then be scanned using YARA to get the actual set of matching ﬁles. Using 32M malware samples and 1404 YARA rules, we show that Y AR I X scales in both disk footprint and search performance. The index requires just ≈ 74% of the space required for storing the malware samples. Querying Y AR I X with a YARA rule in our test setup is ﬁve orders of magnitude faster than using standard sequential YARA scans.