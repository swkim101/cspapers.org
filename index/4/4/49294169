Physically unclonable functions (PUFs) have proved to be an effective measure for secure device authentication and key generation. We propose a novel PUF design, named CamPUF, based on commercial off-the-shelf CMOS image sensors, which are ubiquitously available in almost all mobile devices. The inherent process mismatch between pixel sensors and readout circuits in an image sensor manifests as unique fixed pattern noise (FPN) in the image. We exploit FPN caused by dark signal non-uniformity (DSNU) as the basis for implementing the PUF. DSNU can be extracted only from dark images that are not shared with others, and only the legitimate user can obtain it with full control of the image sensor. Compared to other FPN components that can be extracted from shared images, DSNU facilitates more secure and usable device authentication. We present an eficient and reliable key generation procedure for use in wireless low-power devices. We implement CamPUF on Google Nexus 5X and Nexus 5 and evaluate the uniqueness and robustness of the keys, as well as its security against counterfeiting. We demonstrate that it discriminates legitimate and illegitimate authentication attempts without confusion.