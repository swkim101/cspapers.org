Data analytics are an important class of data-intensive workloads on public cloud services. However, selecting the right compute and storage conﬁguration for these applications is difﬁcult as the space of available options is large and the interactions between options are complex. Moreover, the different data streams accessed by analytics workloads have distinct characteristics that may be better served by different types of storage devices. We present Selecta, a tool that recommends near-optimal conﬁgurations of cloud compute and storage resources for data analytics workloads. Selecta uses latent factor collaborative ﬁltering to predict how an application will perform across different conﬁgurations, based on sparse data collected by proﬁling training workloads. We evaluate Selecta with over one hundred Spark SQL and ML applications, showing that Selecta chooses a near-optimal performance conﬁguration (within 10% of optimal) with 94% probability and a near-optimal cost conﬁguration with 80% probability. We also use Se-lecta to draw signiﬁcant insights about cloud storage systems, including the performance-cost efﬁciency of NVMe Flash devices, the need for cloud storage with support for ﬁne-grain capacity and bandwidth allocation, and the motivation for end-to-end storage optimizations.