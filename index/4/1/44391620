In order to contribute toward the realization of a practical computer-automated process planning system, this paper discusses two essential subjects: geometric reasoning and optimization capabilities. ESPER provides a solution for these two problems. Geometric reasoning mediates between symbolic reasoning and geometric modeling. It implies recognizing various features in geometric data as well as manipulation of these geometries. Optimization requires effective problem solving strategy and, in addition, cooperation between system inference and users' interaction. For problem solving, knowledge is defined so as to avoid divergent search by pruning. Furthermore, users' interactions can be incorporated into the optimization process to obtain a better solution. Through developing the system, it is shown that the methodology proposed here is effective for realizing practical process planning systems.