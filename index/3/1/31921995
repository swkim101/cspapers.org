We describe Razor, a planning-based information-gathering agent that assists users by automatically determining which Internet information sites are relevant to their query, accessing those sites in parallel, and integrating the results. Razor uses a disjunctive graphbased plan representation. It then uses a novel and powerful form of local completeness reasoning in order to transform those plans into contingent plans of high quality. These contingent plans can be e ciently executed, obtaining more answers at less cost than the original plans. We focus in this paper on the algorithms underlying the plan transformation process.