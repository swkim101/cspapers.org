We introduce a mathematical framework to the analysis, design and optimization of Network-Coded Cooperative Diversity (NCCD) protocols. The analysis is applicable to relay-aided protocols based on the error propagation model, which rely on appropriately designed diversity combining demodulators at the destination. Wireless networks with an arbitrary number of sources and relays are considered. Arbitrary multilevel modulations and network codes constructed over a non-binary Galois Field (GF) are analyzed. NCCD protocols based on repetition-based cooperation are investigated. The mathematical analysis shows that NCCD protocols are capable of achieving full-diversity if the GF size is sufficiently large and the network code satisfies the Maximum Distance Separable (MDS) property.