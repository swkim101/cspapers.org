This paper investigates the optimal precoder design and power allocation between the source and relay for a half-duplex single-relay non-orthogonal amplify-and-forward (NAF) system. Based on the pair-wise error probability (PEP) analysis, an optimal class of 2 × 2 precoders is first derived for the traditional power allocation scheme, where one-third of the system power is spent at the relay node, while two-thirds are spent at the source node. Different from optimal unitary precoders proposed earlier, the derived class of precoders indicates that the source should spend all its power transmitting a superposition of the symbols in the broadcast phase, while being silent in the cooperative phase, for optimal asymptotic performance. We then further address the problem of jointly optimal precoder and power allocation for the system under consideration. It is shown that the total power should be equally distributed to the source and the relay, and the source should again spend no power during the cooperative phase for the best asymptotic performance. Analytical and simulation results reveal that the proposed precoders not only exploit full cooperative diversity, but also provide significant coding gain over the optimal unitary precoders. For instance, a coding gain of around 1dB can be attained at the practical BER level of 10−5 for various modulation schemes.