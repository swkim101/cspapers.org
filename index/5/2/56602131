In our previous paper,[1] we have integrated the Robust Optimization framework with the Real Options model to evaluate flexibility, introducing the Flexible-Robust Objective. Flexibility is defined as the energy left to allocate after meeting daily demands. This integration proved more efficient in risk evaluation in energy allocation problems. However, the integration has some limitations in applying operational and physical constraints of the reservoirs. In this paper, an in-depth analysis of all the limitations is discussed. To overcome those limitations and ensure a conceptually correct approach, a bilevel programming approach has been introduced in the second stage of the model to solve the energy allocation problem. We define the proposed model in this paper as Two-Stage, Bi-Level Flexible-Robust Optimization. Stage 1 provides the maximum total flexibility that can be allocated throughout the optimization period. Stage 2 uses bi-level optimization. The Stage 2 upper level sets the target allocation of flexibility in each iteration and maximizes net revenue along with the evaluation of allocated flexibility by the real options model. The Stage 2 lower level minimizes the deviation between the level 1 target and the achievable solution, ensuring no violation in physical and operational constraints of the reservoirs. Some compatibility issues have been identified in integrating the two levels, which have been discussed and solved successfully; the model provides an optimal achievable allocation of flexibility by maximizing net revenue and minimizing violation of constraints. Uncertainty in the objective function and constraints has been handled by converting into a robust objective and probabilistic constraints, respectively. Both classical methods (SQP) and evolutionary methods (GA) with continuous decision variables have been applied to solving the optimization problem, and the results are compared. Also, the result has been compared with the simplified version in previous paper, which was limited to randomly generate discrete decision variables. The new results provided an 8% improvement over the previous simplified model.