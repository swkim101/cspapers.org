We design a new distribution over poly(r ε<sup>-1</sup>) x n matrices S so that for any fixed n x d matrix A of rank r, with probability at least 9/10, SAx<sub>2</sub> = (1 pm ε)Ax<sub>2</sub> simultaneously for all x ∈ R<sup>d</sup>. Such a matrix S is called a <i>subspace embedding</i>. Furthermore, SA can be computed in O(nnz(A)) + ~O(r<sup>2</sup>ε<sup>-2</sup>) time, where nnz(A) is the number of non-zero entries of A. This improves over all previous subspace embeddings, which required at least Ω(nd log d) time to achieve this property. We call our matrices S <i>sparse embedding matrices</i>.
 Using our sparse embedding matrices, we obtain the fastest known algorithms for overconstrained least-squares regression, low-rank approximation, approximating all leverage scores, and l<sub>p</sub>-regression: to output an x' for which Ax'-b<sub>2</sub> ≤ (1+ε)min<sub>x</sub> Ax-b<sub>2</sub> for an n x d matrix A and an n x 1 column vector b, we obtain an algorithm running in O(nnz(A)) + ~O(d<sup>3</sup>ε<sup>-2</sup>) time, and another in O(nnz(A)log(1/ε)) + ~O(d<sup>3</sup>log(1/ε)) time. (Here ~O(f) = f ⋅ log<sup>O(1)</sup>(f).) to obtain a decomposition of an n x n matrix A into a product of an n x k matrix L, a k x k diagonal matrix D, and a n x k matrix W, for which F{A - L D W} ≤ (1+ε)F{A-A<sub>k</sub>}, where A<sub>k</sub> is the best rank-k approximation, our algorithm runs in O(nnz(A)) + ~O(nk<sup>2</sup> ε<sup>-4</sup>log n + k<sup>3</sup>ε<sup>-5</sup>log<sup>2</sup>n) time. to output an approximation to all leverage scores of an n x d input matrix A simultaneously, with constant relative error, our algorithms run in O(nnz(A) log n) + ~O(r<sup>3</sup>) time. to output an x' for which Ax'-b<sub>p</sub> ≤ (1+ε)min<sub>x</sub> Ax-b<sub>p</sub> for an n x d matrix A and an n x 1 column vector b, we obtain an algorithm running in O(nnz(A) log n) + poly(r ε<sup>-1</sup>) time, for any constant 1 ≤ p < ∞. We optimize the polynomial factors in the above stated running times, and show various tradeoffs. Finally, we provide preliminary experimental results which suggest that our algorithms are of interest in practice.