Since its first release, back in 1996, the Monte Carlo code system penelope has evolved into a flexible and reliable tool for describing coupled electron-photon transport in complex material structures. The present article contains an overview of the physical interaction models, particle tracking methods, geometry tools, and variance-reduction techniques implemented in penelope. Recent refinements aimed at improving the accuracy of the code, and its stability under variations of user-defined simulation parameters, are also described. These include the use of reliable cross sections for the ionization of inner atomic electron shells by electron/positron impact, a reformulation of the random-hinge method, and the use of fuzzy quadric surfaces in the description of the geometry.