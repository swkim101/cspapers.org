Los Centros de Datos se encuentran actualmente en cualquier sector de la economia mundial. Estan compuestos por miles de servidores, dando servicio a los usuarios de forma global, las 24 horas del dia y los 365 dias del ano. Durante los ultimos anos, las aplicaciones del ambito de la e-Ciencia, como la e-Salud o las Ciudades Inteligentes han experimentado un desarrollo muy significativo. La necesidad de manejar de forma eficiente las necesidades de computo de aplicaciones de nueva generacion, junto con la creciente demanda de recursos en aplicaciones tradicionales, han facilitado el rapido crecimiento y la proliferacion de los Centros de Datos. El principal inconveniente de este aumento de capacidad ha sido el rapido y dramatico incremento del consumo energetico de estas infraestructuras. En 2010, la factura electrica de los Centros de Datos representaba el 1.3% del consumo electrico mundial. Solo en el ano 2012, el consumo de potencia de los Centros de Datos crecio un 63%, alcanzando los 38GW. En 2013 se estimo un crecimiento de otro 17%, hasta llegar a los 43GW. Ademas, los Centros de Datos son responsables de mas del 2% del total de emisiones de dioxido de carbono a la atmosfera. Esta tesis doctoral se enfrenta al problema energetico proponiendo tecnicas proactivas y reactivas conscientes de la temperatura y de la energia, que contribuyen a tener Centros de Datos mas eficientes. Este trabajo desarrolla modelos de energia y utiliza el conocimiento sobre la demanda energetica de la carga de trabajo a ejecutar y de los recursos de computacion y refrigeracion del Centro de Datos para optimizar el consumo. Ademas, los Centros de Datos son considerados como un elemento crucial dentro del marco de la aplicacion ejecutada, optimizando no solo el consumo del Centro de Datos sino el consumo energetico global de la aplicacion. Los principales componentes del consumo en los Centros de Datos son la potencia de computacion utilizada por los equipos de IT, y la refrigeracion necesaria para mantener los servidores dentro de un rango de temperatura de trabajo que asegure su correcto funcionamiento. Debido a la relacion cubica entre la velocidad de los ventiladores y el consumo de los mismos, las soluciones basadas en el sobre-aprovisionamiento de aire frio al servidor generalmente tienen como resultado ineficiencias energeticas. Por otro lado, temperaturas mas elevadas en el procesador llevan a un consumo de fugas mayor, debido a la relacion exponencial del consumo de fugas con la temperatura. Ademas, las caracteristicas de la carga de trabajo y las politicas de asignacion de recursos tienen un impacto importante en los balances entre corriente de fugas y consumo de refrigeracion. La primera gran contribucion de este trabajo es el desarrollo de modelos de potencia y temperatura que permiten describes estos balances entre corriente de fugas y refrigeracion; asi como la propuesta de estrategias para minimizar el consumo del servidor por medio de la asignacion conjunta de refrigeracion y carga desde una perspectiva multivariable. Cuando escalamos a nivel del Centro de Datos, observamos un comportamiento similar en terminos del balance entre corrientes de fugas y refrigeracion. Conforme aumenta la temperatura de la sala, mejora la eficiencia de la refrigeracion. Sin embargo, este incremente de la temperatura de sala provoca un aumento en la temperatura de la CPU y, por tanto, tambien del consumo de fugas. Ademas, la dinamica de la sala tiene un comportamiento muy desigual, no equilibrado, debido a la asignacion de carga y a la heterogeneidad en el equipamiento de IT. La segunda contribucion de esta tesis es la propuesta de tecnicas de asigacion conscientes de la temperatura y heterogeneidad que permiten optimizar conjuntamente la asignacion de tareas y refrigeracion a los servidores. Estas estrategias necesitan estar respaldadas por modelos flexibles, que puedan trabajar en tiempo real, para describir el sistema desde un nivel de abstraccion alto. Dentro del ambito de las aplicaciones de nueva generacion, las decisiones tomadas en el nivel de aplicacion pueden tener un impacto dramatico en el consumo energetico de niveles de abstraccion menores, como por ejemplo, en el Centro de Datos. Es importante considerar las relaciones entre todos los agentes computacionales implicados en el problema, de forma que puedan cooperar para conseguir el objetivo comun de reducir el coste energetico global del sistema. La tercera contribucion de esta tesis es el desarrollo de optimizaciones energeticas para la aplicacion global por medio de la evaluacion de los costes de ejecutar parte del procesado necesario en otros niveles de abstraccion, que van desde los nodos hasta el Centro de Datos, por medio de tecnicas de balanceo de carga. Como resumen, el trabajo presentado en esta tesis lleva a cabo contribuciones en el modelado y optimizacion consciente del consumo por fugas y la refrigeracion de servidores; el modelado de los Centros de Datos y el desarrollo de politicas de asignacion conscientes de la heterogeneidad; y desarrolla mecanismos para la optimizacion energetica de aplicaciones de nueva generacion desde varios niveles de abstraccion. ABSTRACT Data centers are easily found in every sector of the worldwide economy. They consist of tens of thousands of servers, serving millions of users globally and 24-7. In the last years, e-Science applications such e-Health or Smart Cities have experienced a significant development. The need to deal efficiently with the computational needs of next-generation applications together with the increasing demand for higher resources in traditional applications has facilitated the rapid proliferation and growing of data centers. A drawback to this capacity growth has been the rapid increase of the energy consumption of these facilities. In 2010, data center electricity represented 1.3% of all the electricity use in the world. In year 2012 alone, global data center power demand grew 63% to 38GW. A further rise of 17% to 43GW was estimated in 2013. Moreover, data centers are responsible for more than 2% of total carbon dioxide emissions. This PhD Thesis addresses the energy challenge by proposing proactive and reactive thermal and energy-aware optimization techniques that contribute to place data centers on a more scalable curve. This work develops energy models and uses the knowledge about the energy demand of the workload to be executed and the computational and cooling resources available at data center to optimize energy consumption. Moreover, data centers are considered as a crucial element within their application framework, optimizing not only the energy consumption of the facility, but the global energy consumption of the application. The main contributors to the energy consumption in a data center are the computing power drawn by IT equipment and the cooling power needed to keep the servers within a certain temperature range that ensures safe operation. Because of the cubic relation of fan power with fan speed, solutions based on over-provisioning cold air into the server usually lead to inefficiencies. On the other hand, higher chip temperatures lead to higher leakage power because of the exponential dependence of leakage on temperature. Moreover, workload characteristics as well as allocation policies also have an important impact on the leakage-cooling tradeoffs. The first key contribution of this work is the development of power and temperature models that accurately describe the leakage-cooling tradeoffs at the server level, and the proposal of strategies to minimize server energy via joint cooling and workload management from a multivariate perspective. When scaling to the data center level, a similar behavior in terms of leakage-temperature tradeoffs can be observed. As room temperature raises, the efficiency of data room cooling units improves. However, as we increase room temperature, CPU temperature raises and so does leakage power. Moreover, the thermal dynamics of a data room exhibit unbalanced patterns due to both the workload allocation and the heterogeneity of computing equipment. The second main contribution is the proposal of thermal- and heterogeneity-aware workload management techniques that jointly optimize the allocation of computation and cooling to servers. These strategies need to be backed up by flexible room level models, able to work on runtime, that describe the system from a high level perspective. Within the framework of next-generation applications, decisions taken at this scope can have a dramatical impact on the energy consumption of lower abstraction levels, i.e. the data center facility. It is important to consider the relationships between all the computational agents involved in the problem, so that they can cooperate to achieve the common goal of reducing energy in the overall system. The third main contribution is the energy optimization of the overall application by evaluating the energy costs of performing part of the processing in any of the different abstraction layers, from the node to the data center, via workload management and off-loading techniques. In summary, the work presented in this PhD Thesis, makes contributions on leakage and cooling aware server modeling and optimization, data center thermal modeling and heterogeneityaware data center resource allocation, and develops mechanisms for the energy optimization for next-generation applications from a multi-layer perspective.