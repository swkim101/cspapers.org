We address the problem of partitioning a set of n points into clusters, so as to minimize the sum, over all intracluster pairs of points, of the cost associated with each pair. We obtain a randomized approximation algorithm for this problem, for the cost functions ` 2 2 ;`1 and `2, as well as any cost function isometrically embeddable in ` 2 2 . The maximization problem (maximize the costs of intercluster edges) is approximated with high probability to within multiplicative factor (1 (cid:0) "); while the minimization problem either receives a multiplicative 1+" approximation, or else the optimal clustering is correctly identi(cid:12)ed except for mislabelling of an " fraction of the point set. Given a (cid:12)xed approximation parameter ", the runtime is linear in n for ` 2 2 problems of dimension o(logn=loglogn); and n O(loglogn) in the general case. The case ` 2 2 is addressed by combining three elements: (a) Variable-probability sampling of the given points, to reduce the size of the data set. (b) Near-isometric dimension reduction. (c) A deterministic exact algorithm which runs in time exponential in the dimension (rather than the number of points). The remaining cases are addressed by reduction to ` 2 2 .