Data-center network stacks are moving into hardware to achieve 100 Gbps data rates and beyond at low latency and low CPU utilization. However, hardwiring the network stack in the NIC would stiﬂe innovation in transport protocols. In this paper, we enable programmable transport protocols in high-speed NICs by designing Tonic, a ﬂexible hardware architecture for transport logic. At 100 Gbps, transport protocols must generate a data segment every few nanoseconds using only a few kilobits of per-ﬂow state on the NIC. By identifying common patterns across transport logic of different transport protocols, we design an efﬁcient hardware “template” for transport logic that satisﬁes these constraints while being programmable with a simple API. Experiments with our FPGA-based prototype show that Tonic can support the transport logic of a wide range of protocols and meet timing for 100 Gbps of back-to-back 128-byte packets. That is, every 10 ns, our prototype generates the address of a data segment for one of more than a thousand active ﬂows for a downstream DMA pipeline to fetch and transmit a packet.